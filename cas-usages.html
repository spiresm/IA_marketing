<script>
  const tipsDataBase = [
    {titre:"Utiliser ChatGPT pour rÃ©sumer un article",description:"Collez lâ€™URL ou le contenu de lâ€™article et demandez Ã  ChatGPT un rÃ©sumÃ© en 3 phrases.",prompt:"RÃ©sume cet article en trois phrases claires et concises.",outil:"ChatGPT",categorie:"ProductivitÃ©"},
    {titre:"GÃ©nÃ©rer des idÃ©es de campagne marketing",description:"Formulez votre objectif et votre public cible, et demandez Ã  lâ€™IA des idÃ©es originales avec arguments.",prompt:"Propose 5 idÃ©es de campagne marketing crÃ©atives pour [produit/service], en prÃ©cisant lâ€™axe et la promesse.",outil:"Claude",categorie:"Marketing Digital"},
    {titre:"CrÃ©er un visuel pour les rÃ©seaux sociaux",description:"Utilisez Midjourney ou Firefly avec une description claire du style visuel, du format et du contexte.",prompt:"GÃ©nÃ¨re un visuel au format carrÃ© pour une campagne [thÃ¨me], style moderne, couleurs vives, accroche visible.",outil:"Midjourney",categorie:"Graphisme"},
    {titre:"PrÃ©parer un brief crÃ©atif",description:"Demandez Ã  ChatGPT de structurer les points essentiels dâ€™un brief : objectifs, cible, ton, livrables attendus.",prompt:"CrÃ©e un brief crÃ©atif pour une campagne destinÃ©e Ã  [cible] avec les objectifs, le ton, les livrables attendus.",outil:"ChatGPT",categorie:"Communication"},
    {titre:"RÃ©pondre Ã  des objections dâ€™un partenaire avec lâ€™IA",description:"Simulez un Ã©change avec un partenaire exprimant des rÃ©ticences et testez plusieurs rÃ©ponses avec ChatGPT.",prompt:"Simule une conversation oÃ¹ un partenaire exprime des doutes sur une collaboration. Donne-moi des rÃ©ponses diplomates et convaincantes Ã  formuler.",outil:"ChatGPT",categorie:"Partenariats & Ã‰vÃ¨nements"},
    {titre:"Optimiser un message LinkedIn pour un influenceur",description:"Soumettez un message Ã  lâ€™IA pour optimiser la clartÃ©, le ton et lâ€™impact avant de lâ€™envoyer Ã  un influenceur.",prompt:"Optimise ce message pour LinkedIn afin quâ€™il engage un influenceur dans une collaboration potentielle : [message initial].",outil:"Claude",categorie:"Com. Presse & Influenceurs"},
    {titre:"CrÃ©er une ligne Ã©ditoriale pour une newsletter CRM",description:"Demandez Ã  lâ€™IA de proposer un planning Ã©ditorial mensuel structurÃ© autour dâ€™objectifs CRM.",prompt:"Propose une ligne Ã©ditoriale mensuelle pour une newsletter CRM Ã  destination de [cible], avec un thÃ¨me et un contenu par semaine.",outil:"Notion AI",categorie:"CRM"},
    {titre:"Simuler une prÃ©sentation orale avec lâ€™IA",description:"EntraÃ®nez-vous Ã  pitcher un projet Ã  lâ€™oral en interagissant avec une IA jouant le rÃ´le dâ€™un jury ou dâ€™un client.",prompt:"Pose-moi des questions pour mâ€™entraÃ®ner Ã  prÃ©senter ce projet en 2 minutes, comme si je pitchais devant un jury : [titre du projet].",outil:"ChatGPT",categorie:"PÃ´le CrÃ©a"},
    {titre:"Identifier des tendances Ã©mergentes Ã  partir de mots-clÃ©s",description:"Analysez des listes de mots-clÃ©s avec une IA pour en extraire des tendances et angles dâ€™attaque Ã©ditoriaux.",prompt:"Voici une liste de mots-clÃ©s issus de recherches rÃ©centes : [liste]. Dresse une analyse des tendances Ã©mergentes et opportunitÃ©s associÃ©es.",outil:"Perplexity",categorie:"Positionnement"},
    {titre:"Analyser automatiquement les sentiments clients",description:"Demandez Ã  lâ€™IA dâ€™analyser les retours clients pour en dÃ©gager les sentiments positifs et nÃ©gatifs.",prompt:"Analyse ces avis clients et distingue les 3 principaux points positifs et 3 points dâ€™amÃ©lioration.",outil:"ChatGPT",categorie:"CRM"},
    {titre:"GÃ©nÃ©rer un plan mÃ©dia pour une campagne digitale",description:"Utilisez lâ€™IA pour proposer un plan mÃ©dia multicanal adaptÃ© Ã  votre budget et cible.",prompt:"Propose un plan mÃ©dia digital sur 3 mois pour une marque [secteur], en rÃ©partissant le budget entre rÃ©seaux sociaux, display et search.",outil:"Claude",categorie:"Marketing Digital"},
    {titre:"Automatiser un reporting hebdomadaire",description:"Demandez Ã  lâ€™IA de compiler et structurer vos donnÃ©es clÃ©s en un rapport hebdomadaire prÃªt Ã  partager.",prompt:"GÃ©nÃ¨re un reporting hebdomadaire Ã  partir de ces indicateurs : [liste de KPI], avec points forts et axes dâ€™amÃ©lioration.",outil:"Notion AI",categorie:"ProductivitÃ©"}
  ];

  const userTips = JSON.parse(localStorage.getItem('tips') || '[]');
  const tipsData = [...tipsDataBase, ...userTips];

  let votesData = JSON.parse(localStorage.getItem('votesData') || '[]');
  if (votesData.length !== tipsData.length) {
    votesData = tipsData.map(() => ({ up: 0, down: 0 }));
    localStorage.setItem('votesData', JSON.stringify(votesData));
  }

  function saveVotes() {
    localStorage.setItem('votesData', JSON.stringify(votesData));
  }

  function renderTips() {
    const search = document.getElementById('search').value.toLowerCase();
    const outilFilter = document.getElementById('filtre-outil').value;
    const catFilter = document.getElementById('filtre-categorie').value;
    const container = document.getElementById('tips');
    container.innerHTML = '';

    tipsData.forEach((tip, i) => {
      const haystack = (tip.titre + tip.description + tip.prompt).toLowerCase();
      if ((search && !haystack.includes(search)) || (outilFilter && tip.outil !== outilFilter) || (catFilter && tip.categorie !== catFilter)) return;

      const div = document.createElement('div');
      div.className = 'tip';
      div.onclick = () => toggleDetails(div);

      div.innerHTML = `
        <h2>${tip.titre}</h2>
        <div class="tip-details">
          <p>${tip.description}</p>
          <div class="prompt-box">
            <code id="prompt-${i}" contenteditable>${tip.prompt}</code>
            <button onclick="copierPrompt('prompt-${i}', event)">ğŸ“‹</button>
          </div>
          <div class="tip-category">Outil : ${tip.outil} â€¢ CatÃ©gorie : ${tip.categorie}</div>
          <div class="votes">
            <button onclick="vote(${i}, 'up', event)">ğŸ‘</button><span id="up-${i}">${votesData[i]?.up || 0}</span>
            <button onclick="vote(${i}, 'down', event)">ğŸ‘</button><span id="down-${i}">${votesData[i]?.down || 0}</span>
          </div>
        </div>
      `;
      container.appendChild(div);
    });
  }

  function vote(i, type, e) {
    e.stopPropagation();
    votesData[i][type]++;
    document.getElementById(`${type}-${i}`).textContent = votesData[i][type];
    saveVotes();
  }

  function toggleDetails(el) {
    const details = el.querySelector('.tip-details');
    document.querySelectorAll('.tip-details').forEach(d => { if (d !== details) d.style.display = 'none'; });
    details.style.display = details.style.display === 'block' ? 'none' : 'block';
  }

  function copierPrompt(id, e) {
    e.stopPropagation();
    const content = document.getElementById(id).textContent;
    navigator.clipboard.writeText(content).then(() => alert('Prompt copiÃ© !'));
  }

  renderTips();
</script>
