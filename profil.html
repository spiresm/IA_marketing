<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Créer ou éditer un profil</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    body {
      font-family: sans-serif;
      margin: 0;
      padding: 20px;
      background: #f5f5f5;
    }
    .container {
      max-width: 600px;
      background: white;
      margin: auto;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }
    h1 {
      text-align: center;
      color: #0077b6;
    }
    form {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    input, select, textarea {
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
      font-size: 1rem;
    }
    button {
      padding: 12px;
      background: #0077b6;
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 1rem;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1 id="form-title">Créer un profil</h1>
    <form id="profil-form">
      <input type="text" id="name" placeholder="Nom complet" required />
      <input type="text" id="pole" placeholder="Pôle (ex: CRM, communication...)" />
      <input type="url" id="photo" placeholder="URL de la photo" />
      <label>Outils IA maîtrisés :</label>
      <div id="tools-list"></div>
      <button type="submit" id="submit-btn">Créer</button>
    </form>
  </div>

  <script>
    const allTools = [
      "ChatGPT", "Claude", "Midjourney", "DALL·E", "Stable Diffusion", "Firefly",
      "Runway ML", "Perplexity", "Notion AI", "Gemini", "Copilot", "Bard",
      "Pika", "Sora", "Luma AI", "Kling AI", "Genny by Lovo", "ElevenLabs",
      "Murf", "Voicemaker", "Suno.ai", "MusicFX", "Boomy", "Riffusion",
      "Jules", "Devstral", "Codeium", "Bolt"
    ];

    const params = new URLSearchParams(window.location.search);
    const editName = decodeURIComponent(params.get("edit") || "");
    const profils = JSON.parse(localStorage.getItem("profilsEquipe") || "[]");
    let editingProfil = profils.find(p => p.name === editName);

    const nameInput = document.getElementById("name");
    const poleInput = document.getElementById("pole");
    const photoInput = document.getElementById("photo");
    const toolsDiv = document.getElementById("tools-list");
    const title = document.getElementById("form-title");
    const submitBtn = document.getElementById("submit-btn");

    allTools.forEach(tool => {
      const label = document.createElement("label");
      const checkbox = document.createElement("input");
      checkbox.type = "checkbox";
      checkbox.value = tool;
      label.appendChild(checkbox);
      label.append(" " + tool);
      toolsDiv.appendChild(label);
      toolsDiv.appendChild(document.createElement("br"));
    });

    if (editingProfil) {
      title.textContent = "Modifier le profil";
      submitBtn.textContent = "Mettre à jour";
      nameInput.value = editingProfil.name;
      poleInput.value = editingProfil.pole || "";
      photoInput.value = editingProfil.photo || "";
      (editingProfil.tools || []).forEach(t => {
        const cb = [...toolsDiv.querySelectorAll("input")].find(c => c.value === t);
        if (cb) cb.checked = true;
      });
    }

    document.getElementById("profil-form").addEventListener("submit", function(e) {
      e.preventDefault();
      const updatedProfil = {
        name: nameInput.value,
        pole: poleInput.value,
        photo: photoInput.value,
        tools: [...toolsDiv.querySelectorAll("input:checked")].map(c => c.value)
      };

      const index = profils.findIndex(p => p.name === updatedProfil.name);
      if (index !== -1) {
        profils[index] = updatedProfil;
      } else {
        profils.push(updatedProfil);
      }

      localStorage.setItem("profilsEquipe", JSON.stringify(profils));
      window.location.href = "equipe.html";
    });
  </script>
</body>
</html>
