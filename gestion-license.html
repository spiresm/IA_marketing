<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Gestion des Licences IA</title>
    <style>
        /* CSS INT√âGR√â DIRECTEMENT ICI POUR ASSURER SA PR√âSENCE */

        /* Styles du Header et du Menu (fournis par l'utilisateur) */
        .header {
            text-align: center;
            background: #0077b6;
            color: white;
            padding: 10px 0;
            width: 100%;
            box-sizing: border-box;
            position: relative;
        }

        .header img.logo-ia {
            width: 90px;
            height: auto;
            margin-bottom: 5px;
        }

        .header img.logo-rtbf {
            width: 60px;
            height: auto;
            margin-top: 5px;
        }

        .header-title {
            font-size: 1.6em;
            margin: 5px 0;
            font-weight: bold;
            letter-spacing: 1px;
        }

        .nav-wrapper {
            background-color: #0077b6;
            width: 100%;
        }

        .menu-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 30px;
            box-sizing: border-box;
            background-color: transparent;
        }

        nav {
            display: flex;
            flex-wrap: wrap; /* Permet aux √©l√©ments de passer √† la ligne */
            justify-content: center; /* Centre les √©l√©ments horizontalement */
            padding: 10px 0;
            background-color: transparent;
        }

        nav a {
            text-decoration: none;
            color: white;
            font-weight: bold;
            font-size: 1.1em;
            padding: 8px 12px;
            border-radius: 6px;
            transition: background 0.3s ease;
            position: relative;
            margin: 0 5px; /* Un petit ajustement de marge si le 'gap' ne fonctionne pas bien avec flex-wrap */
            white-space: nowrap; /* Emp√™che le texte des liens de se couper sur plusieurs lignes */
        }

        nav a:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        nav a.active {
            background-color: white;
            color: #0077b6;
        }

        /* Style de la bulle de notification */
        .notif-bubble {
            position: absolute;
            top: -6px;
            right: -12px;
            background: red;
            color: white;
            border-radius: 50%;
            padding: 2px 6px;
            font-size: 12px;
            font-weight: bold;
            display: none;
            text-align: center;
            line-height: 12px;
            z-index: 2;
            min-width: 15px;
        }

        /* NOUVEAUX STYLES pour le bouton DEV dans le header */
        .dev-button-header {
            position: absolute;
            top: 10px;
            right: 15px;
            padding: 5px 10px;
            background-color: #005f99;
            color: #fff;
            text-decoration: none;
            border-radius: 5px;
            font-size: 0.8em;
            font-weight: bold;
            transition: background-color 0.2s ease, transform 0.1s ease;
            z-index: 10;
        }

        .dev-button-header:hover {
            background-color: #0077b6;
            transform: translateY(-1px);
        }

        /* Media Queries pour les tablettes et smartphones */
        @media (max-width: 1024px) {
            .header {
                padding: 10px 0;
            }
            .header img.logo-ia,
            .header img.logo-rtbf {
                width: 80px;
            }
            .header-title {
                font-size: 1.4em;
            }
            .dev-button-header {
                position: absolute;
                top: 10px;
                right: 15px;
                font-size: 0.75em;
            }
            nav {
                justify-content: center;
                padding: 5px 10px;
            }
            nav a {
                flex-basis: auto;
                min-width: unset;
                margin: 5px 8px;
                padding: 7px 10px;
                font-size: 0.95em;
            }
        }

        @media (max-width: 768px) {
            .header {
                padding: 8px 0;
            }
            .header img.logo-ia {
                width: 70px;
            }
            .header img.logo-rtbf {
                width: 50px;
            }
            .header-title {
                font-size: 1.2em;
            }
            .dev-button-header {
                font-size: 0.7em;
                padding: 4px 8px;
            }
            nav {
                padding: 5px;
            }
            nav a {
                font-size: 0.9em;
                padding: 6px 8px;
                margin: 4px 6px;
            }
        }

        /* Styles g√©n√©raux du corps et du conteneur principal */
        body {
            /* Couleurs de fond du mod√®le Demande IA */
            opacity: 0; /* Garde cet √©l√©ment pour la transition JS si utilis√©e */
            margin: 0;
            font-family: sans-serif; /* Police du mod√®le Demande IA */
            background-color: #f0f2f5;
            transition: opacity 0.3s ease-in;
        }
        main {
            /* Initialement cach√©, sera affich√© par JS */
            display: none;
        }

        .container {
            max-width: 900px;
            margin: 40px auto;
            /* Styles du mod√®le Demande IA */
            background: white;
            border-radius: 14px; /* Rayon de bordure plus prononc√© */
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.05); /* Ombre plus douce */
            padding: 40px 35px; /* Padding similaire */
            position: relative;
            z-index: 1;
        }
        h1 {
            text-align: center;
            color: #0077b6; /* Couleur de titre du mod√®le Demande IA */
            margin-bottom: 5px;
        }
        .titre-description {
            text-align: center;
            color: #666;
            font-size: 0.9em;
            margin-bottom: 25px;
            display: block;
        }
        form {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px; /* Espace plus grand comme dans Demande IA */
            margin-bottom: 30px;
            position: relative;
            z-index: 1;
        }
        label {
            /* Styles du mod√®le Demande IA */
            font-weight: 600;
            color: #444;
            display: block;
            margin-bottom: 6px; /* Ajust√© pour coh√©rence avec inputs */
        }
        select, input {
            /* Styles du mod√®le Demande IA */
            width: 100%;
            padding: 12px 14px; /* Padding plus grand */
            border: 1px solid #ccc;
            border-radius: 8px; /* Rayon de bordure plus prononc√© */
            font-size: 1em;
            background-color: #f9fafb; /* Couleur de fond plus claire */
            box-sizing: border-box;
            transition: border-color 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
        }
        select.highlight-field {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292%22%20height%3D%22292%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M283.5%2C197.8L146.7%2C59.9c-4-4.2-10.4-4.2-14.4%2C0L0.5%2C197.8c-4%2C4.2-4%2C11.1%2C0%2C15.3l14.4%2C14.8c4%2C4.2%2C10.4%2C4.2%2C14.4%2C0L146.7%2C98.4c4-4.2%2C10.4-4.2%2C14.4%2C0l117.2%2C129.5c4%2C4.2%2C10.4%2C4.2%2C14.4%2C0l14.4-14.8c4-4.2%2C4-11.1%2C0-15.3z%22%2F%3E%3C%2Fsvg%3E');
            background-repeat: no-repeat;
            background-position: right 0.7em top 50%, 0 0;
            background-size: 0.65em auto, 100%;
        }
        /* Style focus pour les inputs/selects */
        select:focus, input:focus {
            border-color: #0077b6 !important;
            box-shadow: 0 0 5px rgba(0, 119, 182, 0.5) !important;
            outline: none;
        }

        .full {
            grid-column: span 2;
            position: relative;
            z-index: 10;
        }
        button {
            /* Styles du mod√®le Demande IA */
            background-color: #0077b6;
            color: white;
            padding: 10px 12px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: bold;
            margin-top: 15px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        button:hover {
            background-color: #005f8a;
        }
        button:disabled {
            background-color: #a0a0a0;
            cursor: not-allowed;
        }
        button:disabled:hover {
            background-color: #a0a0a0;
        }
        #subscribeButton {
            background-color: #4CAF50; /* Bouton de souscription vert */
            margin-left: 10px;
        }
        #subscribeButton:hover {
            background-color: #45a049;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            margin-top: 30px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #eee; /* Lignes plus claires */
        }
        th {
            background-color: #0077b6; /* Ent√™te de tableau bleu du mod√®le Demande IA */
            color: white;
            font-weight: 600;
        }
        tr:nth-child(even) { /* Bandes altern√©es pour la lisibilit√© */
            background-color: #f8f8f8;
        }
        tr:hover {
            background-color: #eef2f5;
        }
        #totalAchatsContainer {
            grid-column: span 2; /* Conserve la mise en page full-width */
            text-align: right; /* Conserve l'alignement √† droite */
            margin-top: 25px;
            margin-bottom: 20px;
            padding: 15px;
            /* Styles de recap du mod√®le Demande IA appliqu√©s ici */
            background-color: rgb(0, 119, 182); /* Couleur de fond du r√©capitulatif */
            border-radius: 14px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.05);
            color: white; /* Texte en blanc pour le r√©cap */
        }
        #totalAchats {
            font-size: 2.5em;
            font-weight: bold;
            color: #ffffff; /* Couleur du total en blanc */
            margin-top: 5px;
            text-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }
        #totalAchatsLabel {
            font-size: 0.9em;
            color: #e0e0e0; /* Couleur du label en gris clair */
            display: block;
        }
        /* Style pour les totaux par p√¥le */
        #poleTotalsList {
            font-size: 0.9em;
            color: #e0e0e0; /* Texte en gris clair */
            margin-top: 15px;
            list-style: none;
            padding: 0;
            text-align: right; /* Aligner le texte de la liste √† droite */
        }
        #poleTotalsList li {
            margin-bottom: 5px;
            padding: 2px 0;
        }
        #poleTotalsList strong {
            color: #ffffff;
        }

        .cout-rouge-gras {
            font-weight: bold;
            color: #dc3545; /* Rouge pour le co√ªt n√©gatif ou nul */
        }
        input[type="text"].cout-input-rouge {
            font-weight: bold !important;
            color: #dc3545 !important;
            border-color: #dc3545 !important;
            box-shadow: 0 0 5px rgba(220, 53, 69, 0.5) !important;
        }
        .highlight-field {
            border-color: #0077b6 !important; /* Couleur de surbrillance du mod√®le */
            box-shadow: 0 0 5px rgba(0, 119, 182, 0.5) !important;
        }
        .table-link {
            color: #0077b6; /* Liens dans le tableau de la couleur principale */
            text-decoration: none;
        }
        .table-link:hover {
            text-decoration: underline;
        }
        #footer-signature {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            font-size: 0.85em;
            color: #555;
            border-top: 1px solid #eee;
        }
        #footer-signature strong {
            color: #333;
        }
        /* Style pour le filtre du tableau */
        .table-filter-container {
            margin-bottom: 15px;
            text-align: right;
            padding-right: 10px; /* Pour aligner avec le padding du conteneur */
        }
        .table-filter-container label {
            display: inline-block;
            margin-right: 10px;
            font-weight: 600;
            color: #444;
        }
        .table-filter-container select {
            width: auto;
            min-width: 180px;
            padding: 8px 12px;
            border-radius: 8px;
            border: 1px solid #ccc;
            background-color: #f9fafb;
            font-size: 1em;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292%22%20height%3D%22292%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M283.5%2C197.8L146.7%2C59.9c-4-4.2-10.4-4.2-14.4%2C0L0.5%2C197.8c-4%2C4.2-4%2C11.1%2C0%2C15.3l14.4%2C14.8c4%2C4.2%2C10.4%2C4.2%2C14.4%2C0L146.7%2C98.4c4-4.2%2C10.4-4.2%2C14.4%2C0l117.2%2C129.5c4%2C4.2%2C10.4%2C4.2%2C14.4%2C0l14.4-14.8c4-4.2%2C4-11.1%2C0-15.3z%22%2F%3E%3C%2Fsvg%3E');
            background-repeat: no-repeat;
            background-position: right 0.7em top 50%, 0 0;
            background-size: 0.65em auto, 100%;
        }

        /* Styles pour les messages Toast */
        #toast-container {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
            display: flex;
            flex-direction: column;
            align-items: center;
            pointer-events: none;
        }
        .toast-message {
            background-color: rgba(51, 51, 51, 0.9);
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            margin-bottom: 10px;
            opacity: 0;
            transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
            transform: translateY(20px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            min-width: 250px;
            text-align: center;
            font-weight: bold;
        }
        .toast-message.show {
            opacity: 1;
            transform: translateY(0);
        }
        .toast-message.success {
            background-color: rgba(40, 167, 69, 0.9);
        }
        .toast-message.error {
            background-color: rgba(220, 53, 69, 0.9);
        }
        /* Style pour le bouton supprimer dans le tableau (ic√¥ne) */
        .btn-supprimer {
            background: none;
            border: none;
            font-size: 1.1em;
            cursor: pointer;
            padding: 4px;
            color: #dc3545; /* Couleur rouge pour l'ic√¥ne */
            transition: transform 0.2s ease;
        }
        .btn-supprimer:hover {
            transform: scale(1.2);
        }
    </style>
</head>
<body>
    <div class="header">
        <img src="log_ia.png" alt="Logo IA Marketing" class="logo-ia">
        <h1 class="header-title">IA MARKETING</h1> <img src="Section-Clients-Logo-RTBF.png" alt="Logo RTBF" class="logo-rtbf">
        <a href="about.html" class="dev-button-header">DEV</a>
    </div>

    <div class="nav-wrapper">
        <div class="menu-container">
            <nav>
                <a href="index.html">Accueil</a>
                <a href="equipe.html">√âquipe</a>
                <a href="outils.html">Outils IA</a>
                <a href="galerie.html">Galerie</a>
                <a href="Cas-usages.html">Tips</a>
                <a href="veille.html">Veille</a>
                <a href="charte.html">Charte IA</a>
                <a href="faq.html">FAQ</a>
                <a href="demandes_ia.html" class="demandes">
                    Demandes IA
                    <span class="notif-bubble" id="notif-count">0</span>
                </a>
                <a href="gestion-license.html" class="active">Licenses</a>
            </nav>
        </div>
    </div>
    <main>
        <div class="container">
            <h1>Outil de Gestion des Licences IA</h1>
            <span class="titre-description">Pour Charlotte DELWARTE - Coordinateur(trice) de moyens de production marketing - M√©dias - Marketing & Communication</span>

            <form id="licenseForm">
                <div class="full">
                    <label for="pole">P√¥le :</label>
                    <select id="pole" required="">
                        <option value="">-- S√©lectionner un p√¥le --</option>
                        <option>P√¥le cr√©a.</option>
                        <option>CRM</option>
                        <option>Communication</option>
                        <option>Partenariats</option>
                        <option>Marketing digital</option>
                        <option>Positionnement</option>
                        <option>Staff</option>
                    </select>
                </div>

                <div>
                    <label for="collaborateur">Collaborateur :</label>
                    <select id="collaborateur" required="">
                        <option value="">-- S√©lectionner --</option>
                    </select>
                </div>
                <div>
                    <label for="licence">Licence :</label>
                    <select id="licence" required="">
                        <option value="">-- S√©lectionner --</option>
                        <option>Midjourney</option>
                        <option>ChatGPT</option>
                        <option>Runway</option>
                        <option>Netlify</option>
                        <option>VEO3</option>
                        <option>Gemini</option>
                        <option>Kling AI</option>
                        <option>ElevenLabs</option>
                    </select>
                </div>
                <div class="full">
                    <label for="description">Description :</label>
                    <input id="description" readonly="readonly" type="text"/>
                </div>
                <div>
                    <label for="type">Type de licence :</label>
                    <select id="type" required=""></select>
                </div>
                <div>
                    <label for="cout">Co√ªt (EUR) :</label>
                    <input id="cout" required="" type="text"/>
                </div>
                <div>
                    <label for="periodeCout">P√©riode du co√ªt :</label>
                    <select id="periodeCout" required="">
                        <option value="">-- S√©lectionner --</option>
                        <option value="mois">Par mois</option>
                        <option value="annee">Par ann√©e</option>
                    </select>
                </div>
                <div>
                    <label for="dateAchat">Date d'achat :</label>
                    <input id="dateAchat" required="" type="date"/>
                </div>
                <div>
                    <label for="dateRenouvellement">Date de renouvellement :</label>
                    <input id="dateRenouvellement" type="text" readonly="readonly"/>
                </div>

                <div class="full">
                    <button type="submit" id="addButton" disabled>Ajouter</button>
                    <button type="button" id="downloadButton">T√©l√©charger la liste</button>
                    <button id="subscribeButton" type="button" style="display: none;">Souscrire √† la Licence</button>
                </div>

                <div id="totalAchatsContainer">
                    <span id="totalAchatsLabel">Co√ªt Annuel Estim√© des Licences :</span>
                    <div id="totalAchats">0,00 EUR</div>
                    <ul id="poleTotalsList"></ul>
                </div>
            </form>

            <div class="table-filter-container">
                <label for="tablePoleFilter">Filtrer par P√¥le :</label>
                <select id="tablePoleFilter">
                    <option value="all">Tout</option>
                </select>
            </div>

            <table id="listeLicences">
                <thead>
                    <tr>
                        <th>P√¥le</th>
                        <th>Collaborateur</th>
                        <th>Licence</th>
                        <th>Type</th>
                        <th>Co√ªt</th>
                        <th>P√©riode</th>
                        <th>Date d'achat</th>
                        <th>Date de renouvellement</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </main>

    <div id="toast-container"></div>

    <div id="footer-signature">
        D√©velopp√© par <strong>Steeve PIRES MADEIRA</strong><br>
        Charg√©(e) de projets - R&D format ‚Ä¢ M√©dias - Marketing & Communication
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.1/jspdf.plugin.autotable.min.js"></script>

    <script>
        console.log("Script JavaScript charg√© et d√©marr√©.");

        const TAUX_DE_CONVERSION_USD_EUR = 0.93;

        const collaborateursParPole = {
            "P√¥le cr√©a.": [
                "Anne-Fran√ßoise LELEUX", "Baptiste TARTAS", "B√©atrice MARLIER",
                "Boris TEIRLYNCK", "Charlotte DELWARTE", "C√©line DELENTREE", "Delphine BENROUBI",
                "Faiza BOUMEDIAN", "Genevi√®ve DE BEAUFFORT", "Giovanni CASCONE",
                "Gregory KEPPENS", "Isabelle MARCHAL", "Isabelle VERTUONGEN",
                "Jimmy DEGR√àVE", "Joel VAN HOEF", "Jonathan LACROIX",
                "Jose ROJO", "Jose-Luis PENAFUERTE", "Mehdi HUSAIN",
                "Michael EVRARD", "Patricia DAVIA", "Pierre LERMIER",
                "Pierre-Jean GILOUX", "Steeve PIRES MADEIRA",
                "Susana GONCALVES VALERIO",
                "Tyan HOOGSTOEL", "Vinciane LE MEN",
                "Sabrina LECLERCQ",
                "Nathalie AUBRY",
                "Jeremy DEHERTOGH",
                "Dominique LEFEVRE",
                "Virginie LONGE"
            ].sort(),

            "CRM": [
                "Fr√©d√©ric CARTON", "In√®s BERNOUX", "No√©mie ROSSEY",
                "Yasmine AIT MASKOUR"
            ].sort(),

            "Communication": [
                "Aurore CRABBE", "Elvis TCHANA", "Fabienne CULLUS",
                "Marie NAUWELAERTS", "R√©gine CARPENTIER"
            ].sort(),

            "Partenariats": [
                "Alinoe VANHAUDENHUYSE", "Catherine CARA", "Dominique CAFFIERS",
                "Fiona KOPEINIG", "Isabelle DELENS",
                "Laura DONATELLO", "Marie-Rose ANGE", "Na√Øm EL BOHALI",
                "Nathalie DE RIJCKE"
            ].sort(),

            "Marketing digital": [
                "Elise FONCK", "Ga√´lle DEGEYE",
                "Mathilde ARMILLAC", "Morgane CARLY", "Yasmine GHAZOUANE",
                "Sara GARCIA"
            ].sort(),

            "Positionnement": [
                "Amelie DE LANGE", "Philippe BLANJEAN",
                "Samuel LALOUX"
            ].sort(),

            "Staff": [
                "Meltem SIVLIN", "Nadia CURTO", "Vincent CRABBE",
                "Olivier LEIDGENS", "Pierre DUBOIS", "Vitold GRAND'HENRY",
                "Romain DELECOUR", "Noemie GORISSEN"
            ].sort()
        };


        const typesParOutil = {
            "Midjourney": [
                {"type": "Basic", "description": "Acc√®s limit√© aux g√©n√©rations, usage individuel", "cout_mois": 10, "cout_annee": 96, "url": "https://www.midjourney.com/account"},
                {"type": "Standard", "description": "Usage mod√©r√© pour un utilisateur", "cout_mois": 30, "cout_annee": 288, "url": "https://www.midjourney.com/account"},
                {"type": "Pro", "description": "Usage illimit√©, 1 utilisateur", "cout_mois": 60, "cout_annee": 576, "url": "https://www.midjourney.com/account"}
            ],
            "ChatGPT": [
                {"type": "Free", "description": "Acc√®s limit√© √† GPT-3.5, usage individuel", "cout_mois": 0, "cout_annee": 0, "url": "https://openai.com/chatgpt/pricing/"},
                {"type": "Plus", "description": "Acc√®s GPT-4 pour 1 utilisateur", "cout_mois": 20, "cout_annee": 192, "url": "https://openai.com/chatgpt/pricing/"},
                {"type": "Teams", "description": "Collaboration pour 3 √† 10 utilisateurs", "cout_mois": 150, "cout_annee": 1440, "url": "https://openai.com/chatgpt/pricing/"},
                {"type": "Enterprise", "description": "Solution entreprise pour +100 utilisateurs", "cout_mois": 300, "cout_annee": 2880, "url": "https://openai.com/chatgpt/pricing/"}
            ],
            "Runway": [
                {"type": "Standard", "description": "Fonctionnalit√©s de base, 1 utilisateur", "cout_mois": 15, "cout_annee": 144, "url": "https://runwayml.com/"},
                {"type": "Pro", "description": "Fonctionnalit√©s avanc√©es pour 1-3 utilisateurs", "cout_mois": 35, "cout_annee": 336, "url": "https://runwayml.com/"},
                {"type": "Unlimited", "description": "Utilisation illimit√©e, jusqu'√† 5 utilisateurs", "cout_mois": 912/12, "cout_annee": 912, "url": "https://runwayml.com/"}
            ],
            "Netlify": [
                {"type": "Free", "description": "Pour d√©veloppeurs individuels", "cout_mois": 0, "cout_annee": 0, "url": "https://www.netlify.com/"},
                {"type": "Pro", "description": "Projets avanc√©s, 1 utilisateur", "cout_mois": 19, "cout_annee": 182, "url": "https://www.netlify.com/"},
                {"type": "Business", "description": "Collaboration pour √©quipes de 5 √† 10", "cout_mois": 99, "cout_annee": 950, "url": "https://www.netlify.com/"},
                {"type": "Enterprise", "description": "Grandes organisations (+25 utilisateurs)", "cout_mois": 300, "cout_annee": 2880, "url": "https://www.netlify.com/"}
            ],
            "VEO3": [
                {"type": "Cr√©dits gratuits", "description": "Cr√©dits de base gratuits", "cout_mois": 0, "cout_annee": 0, "url": "https://www.veo3.com/"},
                {"type": "Basic", "description": "Plan personnel standard", "cout_mois": 19.99, "cout_annee": 219.90, "url": "https://www.veo3.com/"},
                {"type": "Standard", "description": "Plan avanc√©, plus de cr√©dits", "cout_mois": 49.99, "cout_annee": 549.90, "url": "https://www.veo3.com/"},
                {"type": "Enterprise", "description": "Solution entreprise, personnalis√©e", "cout_mois": 71.99, "cout_annee": 863.90, "url": "https://www.veo3.com/"}
            ],
            "Gemini": [
                {"type": "Version gratuite", "description": "Acc√®s de base √† Gemini", "cout_mois": 0, "cout_annee": 0, "url": "https://gemini.google.com/"},
                {"type": "AI Pro", "description": "Pour utilisateurs personnels et petites entreprises", "cout_mois": 19.99, "cout_annee": 192, "url": "https://gemini.google.com/advanced"},
                {"type": "AI Ultra", "description": "Acc√®s premium complet", "cout_mois": 249.99, "cout_annee": 2749.90, "url": "https://gemini.google.com/ultra"},
                {"type": "Cloud Code Assist Std", "description": "Assistance code dans le cloud", "cout_mois": 22.80, "cout_annee": 19, "url": "https://cloud.google.com/code-assist"}
            ],
            "Kling AI": [
                {"type": "Cr√©dits gratuits", "description": "Cr√©dits de base pour d√©marrer", "cout_mois": 0, "cout_annee": 0, "url": "https://kling.ai/"},
                {"type": "Pro", "description": "Acc√®s Pro avec plus de fonctionnalit√©s", "cout_mois": 10, "cout_annee": Math.round(10 * 12 * 0.66), "url": "https://kling.ai/pro"},
                {"type": "Avanc√©", "description": "Plan avanc√© avec support prioritaire", "cout_mois": 25, "cout_annee": Math.round(25 * 12 * 0.66), "url": "https://kling.ai/advanced"}
            ],
            "ElevenLabs": [
                {"type": "Gratuit", "description": "10k cr√©dits, usage limit√©", "cout_mois": 0, "cout_annee": 0, "url": "https://elevenlabs.io/"},
                {"type": "Starter", "description": "Voix TTS, usage commercial", "cout_mois": 5, "cout_annee": 5 * 12, "url": "https://elevenlabs.io/pricing"},
                {"type": "Creator", "description": "Plus de cr√©dits, fonctionnalit√©s avanc√©es", "cout_mois": 100, "cout_annee": 100 * 12, "url": "https://elevenlabs.io/pricing"}
            ]
        };

        const LOCAL_STORAGE_KEY = 'licencesListCharlotte';
        let licencesData = [];

        function showToast(message, type = 'info') {
            const toastContainer = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = `toast-message ${type}`;
            toast.textContent = message;
            toastContainer.appendChild(toast);

            void toast.offsetWidth;
            toast.classList.add('show');

            setTimeout(() => {
                toast.classList.remove('show');
                toast.addEventListener('transitionend', () => toast.remove(), { once: true });
            }, 3000);
        }

        const formatDate = (date) => {
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            return date.toLocaleDateString('fr-FR', options);
        };

        function updateRenewalDate(dateAchatStr, periodeCout) {
            const dateRenouvellementInput = document.getElementById('dateRenouvellement');
            if (!dateRenouvellementInput) return;

            dateRenouvellementInput.value = '';

            if (!dateAchatStr) {
                dateRenouvellementInput.value = "Date d'achat requise";
                return;
            }

            const dateAchat = new Date(dateAchatStr);
            if (isNaN(dateAchat.getTime())) {
                dateRenouvellementInput.value = "Date d'achat invalide";
                return;
            }

            let renewalDate = new Date(dateAchat);

            if (periodeCout === 'mois') {
                renewalDate.setMonth(renewalDate.getMonth() + 1);
                const currentYear = new Date().getFullYear();
                const nextMonthYear = renewalDate.getFullYear();
                const yearText = (nextMonthYear === currentYear) ? '' : ` (${nextMonthYear})`;
                dateRenouvellementInput.value = `Le mois prochain, le ${renewalDate.getDate()} ${formatDate(renewalDate).split(' ')[1]}${yearText}`;
            } else if (periodeCout === 'annee') {
                renewalDate.setFullYear(renewalDate.getFullYear() + 1);
                dateRenouvellementInput.value = `L'ann√©e prochaine, le ${formatDate(renewalDate)}`;
            }
        }

        function updateCostInput(selectedOption, periodeCout) {
            const costInput = document.getElementById('cout');
            if (!costInput) return;

            let costInUsd = 0;
            if (selectedOption && selectedOption.hasAttribute('data-cout-mois')) {
                if (periodeCout === 'mois') {
                    costInUsd = parseFloat(selectedOption.getAttribute('data-cout-mois'));
                } else if (periodeCout === 'annee') {
                    costInUsd = parseFloat(selectedOption.getAttribute('data-cout-annee'));
                }
            }
            costInput.value = (costInUsd * TAUX_DE_CONVERSION_USD_EUR).toFixed(2).replace('.', ',');

            const coutValue = parseFloat(costInput.value.replace(',', '.'));
            if (isNaN(coutValue) || coutValue <= 0) {
                costInput.classList.add('cout-input-rouge');
            } else {
                costInput.classList.remove('cout-input-rouge');
            }
        }

        function updateCollaborators(pole) {
            const collaborateurSelect = document.getElementById('collaborateur');
            if (!collaborateurSelect) return;

            collaborateurSelect.innerHTML = '<option value="">-- S√©lectionner --</option>';

            if (pole && collaborateursParPole[pole]) {
                collaborateursParPole[pole].sort().forEach(collab => {
                    const option = document.createElement('option');
                    option.value = collab;
                    option.textContent = collab;
                    collaborateurSelect.appendChild(option);
                });
            }
            checkFormValidity();
        }

        function updateTypes(licence) {
            const typeSelect = document.getElementById('type');
            const descBox = document.getElementById('description');
            const costInput = document.getElementById('cout');
            const periodeCoutSelect = document.getElementById('periodeCout');
            const dateAchatInput = document.getElementById('dateAchat');

            if (!typeSelect || !descBox || !costInput || !periodeCoutSelect || !dateAchatInput) return;

            typeSelect.innerHTML = '';
            descBox.value = '';
            costInput.value = '';
            periodeCoutSelect.value = '';

            if (typesParOutil[licence]) {
                typesParOutil[licence].forEach(obj => {
                    const option = document.createElement('option');
                    option.value = obj.type;
                    option.textContent = obj.type;
                    option.setAttribute('data-description', obj.description);
                    option.setAttribute('data-cout-mois', obj.cout_mois);
                    option.setAttribute('data-cout-annee', obj.cout_annee);
                    if (obj.url) {
                        option.setAttribute('data-url', obj.url);
                    }
                    typeSelect.appendChild(option);
                });
                const first = typeSelect.options[0];
                if (first) {
                    typeSelect.value = first.value;
                    descBox.value = first.getAttribute('data-description');
                }
            }
            updateRenewalDate(dateAchatInput.value, periodeCoutSelect.value);
            checkFormValidity();
        }

        function loadLicences() {
            const storedData = localStorage.getItem(LOCAL_STORAGE_KEY);
            if (storedData) {
                licencesData = JSON.parse(storedData);
                renderLicencesTable();
            }
        }

        function saveLicences() {
            localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(licencesData));
        }

        function renderLicencesTable() {
            const tableBody = document.querySelector('#listeLicences tbody');
            if (!tableBody) return;

            tableBody.innerHTML = '';

            licencesData.forEach((licence, index) => {
                const newRow = tableBody.insertRow();
                newRow.insertCell().textContent = licence.pole;
                newRow.insertCell().textContent = licence.collaborateur;

                const licenceCell = newRow.insertCell();
                const licenceLink = document.createElement('a');
                licenceLink.href = licence.url || '#';
                licenceLink.textContent = licence.licence;
                licenceLink.target = '_blank';
                licenceLink.classList.add('table-link');
                licenceCell.appendChild(licenceLink);

                newRow.insertCell().textContent = licence.type;

                const coutCell = newRow.insertCell();
                coutCell.innerHTML = `<span class="cout-rouge-gras">${parseFloat(licence.cout).toFixed(2).replace('.', ',')} EUR</span>`;

                newRow.insertCell().textContent = licence.periodeCout === 'mois' ? 'Par mois' : 'Par ann√©e';
                newRow.insertCell().textContent = licence.dateAchat;
                newRow.insertCell().textContent = licence.dateRenouvellementAffichee;

                const actionCell = newRow.insertCell();
                const deleteButton = document.createElement('button');
                deleteButton.textContent = 'üóëÔ∏è';
                deleteButton.title = 'Supprimer';
                deleteButton.classList.add('btn-supprimer');
                deleteButton.addEventListener('click', function() {
                    if (confirm("√ätes-vous s√ªr de vouloir supprimer cette licence ?")) {
                        deleteLicence(index);
                        showToast('Licence supprim√©e avec succ√®s !', 'success');
                    }
                });
                actionCell.appendChild(deleteButton);
            });
            calculateTotal();
            filterTableByPole();
        }

        function deleteLicence(index) {
            licencesData.splice(index, 1);
            saveLicences();
            renderLicencesTable();
            checkFormValidity();
        }

        function calculateTotal() {
            const totalAchatsElement = document.getElementById('totalAchats');
            const poleTotalsList = document.getElementById('poleTotalsList');
            if (!totalAchatsElement || !poleTotalsList) return;

            let totalGlobalCostEUR = 0;
            let totauxParPole = {};

            licencesData.forEach(licence => {
                let cost = parseFloat(licence.cout);
                let annualCost = (licence.periodeCout === 'mois') ? cost * 12 : cost;

                totalGlobalCostEUR += annualCost;

                if (!totauxParPole[licence.pole]) {
                    totauxParPole[licence.pole] = 0;
                }
                totauxParPole[licence.pole] += annualCost;
            });

            totalAchatsElement.textContent = `${totalGlobalCostEUR.toFixed(2).replace('.', ',')} EUR`;

            poleTotalsList.innerHTML = '';
            const sortedPoles = Object.keys(totauxParPole).sort();
            sortedPoles.forEach(pole => {
                const listItem = document.createElement('li');
                listItem.textContent = `${pole}: `;
                const span = document.createElement('strong');
                span.textContent = `${totauxParPole[pole].toFixed(2).replace('.', ',')} EUR`;
                listItem.appendChild(span);
                poleTotalsList.appendChild(listItem);
            });
        }

        function checkFormValidity() {
            const pole = document.getElementById('pole');
            const collaborateur = document.getElementById('collaborateur');
            const licence = document.getElementById('licence');
            const type = document.getElementById('type');
            const cout = document.getElementById('cout');
            const periodeCout = document.getElementById('periodeCout');
            const dateAchat = document.getElementById('dateAchat');
            const addButton = document.getElementById('addButton');
            const subscribeButton = document.getElementById('subscribeButton');

            if (!pole || !collaborateur || !licence || !type || !cout || !periodeCout || !dateAchat || !addButton || !subscribeButton) {
                console.warn("Certains √©l√©ments du formulaire sont manquants pour la v√©rification de validit√©.");
                return;
            }

            const coutValue = cout.value.replace(',', '.');
            const isCoutValid = !isNaN(parseFloat(coutValue)) && parseFloat(coutValue) > 0;

            const isPoleSelected = pole.value !== "" && !pole.options[pole.selectedIndex].textContent.startsWith('-- S√©lectionner');
            const isCollaborateurSelected = collaborateur.value !== "" && !collaborateur.options[collaborateur.selectedIndex].textContent.startsWith('-- S√©lectionner');
            const isLicenceSelected = licence.value !== "" && !licence.options[licence.selectedIndex].textContent.startsWith('-- S√©lectionner');
            const isTypeSelected = type.options.length > 0 && type.value !== "" && !type.options[type.selectedIndex].textContent.startsWith('-- S√©lectionner');
            const isPeriodeCoutSelected = periodeCout.value !== "" && !periodeCout.options[periodeCout.selectedIndex].textContent.startsWith('-- S√©lectionner');
            const isDateAchatValid = !!dateAchat.value;

            const isFormCompletelyValid = isPoleSelected && isCollaborateurSelected && isLicenceSelected && isTypeSelected && isCoutValid && isPeriodeCoutSelected && isDateAchatValid;

            if (isFormCompletelyValid) {
                addButton.disabled = false;
                subscribeButton.style.display = 'inline-block';
            } else {
                addButton.disabled = true;
                subscribeButton.style.display = 'none';
            }
        }

        function goToSubscriptionPage() {
            const licenceName = document.getElementById('licence').value;
            const typeName = document.getElementById('type').value;
            const collaborateurName = document.getElementById('collaborateur').value;
            const poleName = document.getElementById('pole').value;

            let toolUrl = '';
            const selectedLicenceData = typesParOutil[licenceName];
            if (selectedLicenceData) {
                const specificTypeData = selectedLicenceData.find(item => item.type === typeName);
                if (specificTypeData && specificTypeData.url) {
                    toolUrl = specificTypeData.url;
                } else if (selectedLicenceData[0] && selectedLicenceData[0].url) {
                    toolUrl = selectedLicenceData[0].url;
                }
            }
            if (!toolUrl) {
                toolUrl = 'https://example.com/souscription';
                console.warn(`URL non trouv√©e pour ${licenceName} - ${typeName}. Utilisation d'une URL g√©n√©rique.`);
            }

            const url = `${toolUrl}?type=${encodeURIComponent(typeName)}&collaborateur=${encodeURIComponent(collaborateurName)}&pole=${encodeURIComponent(poleName)}`;

            alert(`Redirection vers la page de souscription pour ${licenceName} (${typeName}) pour ${collaborateurName} du p√¥le ${poleName}...\nURL simul√©e: ${url}`);
            window.open(url, '_blank');
        }

        function telecharger() {
            const headers = ['P√¥le', 'Collaborateur', 'Licence', 'Type', 'Co√ªt', 'P√©riode', 'Date d\'achat', 'Date de renouvellement'];
            const data = licencesData.map(licence => [
                licence.pole,
                licence.collaborateur,
                licence.licence,
                licence.type,
                `${parseFloat(licence.cout).toFixed(2).replace('.', ',')} EUR`,
                licence.periodeCout === 'mois' ? 'Par mois' : 'Par ann√©e',
                licence.dateAchat,
                licence.dateRenouvellementAffichee
            ]);

            const { jsPDF } = window.jspdf;
            const doc = new jsPDF('p', 'mm', 'A4');

            doc.setFontSize(18);
            doc.text("Liste des Licences IA - Charlotte DELWARTE", 14, 22);
            doc.setFontSize(11);
            doc.setTextColor(100);
            doc.text(`G√©n√©r√© le ${new Date().toLocaleDateString('fr-FR')} √† ${new Date().toLocaleTimeString('fr-FR')}`, 14, 30);


            doc.autoTable({
                startY: 40,
                head: [headers],
                body: data,
                theme: 'striped',
                headStyles: { fillColor: [0, 119, 182] },
                styles: {
                    font: 'helvetica',
                    fontSize: 9,
                    cellPadding: 3,
                    valign: 'middle',
                    overflow: 'linebreak'
                },
                columnStyles: {
                    0: { cellWidth: 20 },
                    1: { cellWidth: 30 },
                    2: { cellWidth: 25 },
                    3: { cellWidth: 25 },
                    4: { cellWidth: 20, halign: 'right' },
                    5: { cellWidth: 20 },
                    6: { cellWidth: 25 },
                    7: { cellWidth: 30 },
                    8: { cellWidth: 15 }
                },
                didParseCell: function(data) {
                    if (data.column.index === 4 && data.cell.section === 'body') {
                        data.cell.styles.fontStyle = 'bold';
                        data.cell.styles.textColor = [220, 53, 69];
                    }
                }
            });

            doc.save('liste_licences_ia.pdf');
            console.log('PDF g√©n√©r√© et t√©l√©charg√©.');
        }

        function filterTableByPole() {
            const filterValue = document.getElementById('tablePoleFilter').value;
            const tableRows = document.querySelectorAll('#listeLicences tbody tr');

            tableRows.forEach(row => {
                const poleCell = row.cells[0];
                if (filterValue === 'all' || poleCell.textContent === filterValue) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        }


        document.addEventListener('DOMContentLoaded', function() {
            console.log("DOM enti√®rement charg√©. D√©but de l'initialisation des √©couteurs d'√©v√©nements...");

            const poleSelect = document.getElementById('pole');
            const collaborateurSelect = document.getElementById('collaborateur');
            const licenceSelect = document.getElementById('licence');
            const typeSelect = document.getElementById('type');
            const periodeCoutSelect = document.getElementById('periodeCout');
            const dateAchatInput = document.getElementById('dateAchat');
            const coutInput = document.getElementById('cout');
            const licenseForm = document.getElementById('licenseForm');
            const downloadButton = document.getElementById('downloadButton');
            const subscribeButton = document.getElementById('subscribeButton');
            const addButton = document.getElementById('addButton');
            const tablePoleFilter = document.getElementById('tablePoleFilter');

            // Mise √† jour : le main est affich√© une fois que le DOM est pr√™t
            document.body.style.opacity = "1";
            const mainElement = document.querySelector("main");
            if (mainElement) {
                mainElement.style.display = "block";
            }

            // Gestion de la classe 'active' pour le menu
            const currentPath = window.location.pathname.split('/').pop();
            document.querySelectorAll('nav a').forEach(link => {
                // Pour les liens qui contiennent un span (comme "Demandes IA"), le href est sur le <a> parent
                const linkHref = link.getAttribute('href');
                if (linkHref && linkHref.includes(currentPath)) {
                    link.classList.add('active');
                } else {
                    link.classList.remove('active');
                }
            });

            if (addButton) {
                addButton.disabled = true;
            } else {
                console.error('Erreur: √âl√©ment #addButton non trouv√©!');
            }

            if (poleSelect) {
                poleSelect.addEventListener('change', function() {
                    console.log('√âv√©nement: P√¥le changed');
                    updateCollaborators(this.value);
                    checkFormValidity();
                });
                console.log('√âcouteur p√¥le attach√©.');
            } else { console.error('Erreur: √âl√©ment #pole non trouv√©!'); }

            if (collaborateurSelect) {
                collaborateurSelect.addEventListener('change', function() {
                    console.log('√âv√©nement: Collaborateur changed');
                    checkFormValidity();
                });
                console.log('√âcouteur collaborateur attach√©.');
            } else { console.error('Erreur: √âl√©ment #collaborateur non trouv√©!'); }

            if (licenceSelect) {
                licenceSelect.addEventListener('change', function() {
                    console.log('√âv√©nement: Licence changed');
                    updateTypes(this.value);
                });
                console.log('√âcouteur licence attach√©.');
            } else { console.error('Erreur: √âl√©ment #licence non trouv√©!'); }

            if (typeSelect) {
                typeSelect.addEventListener('change', function() {
                    console.log('√âv√©nement: Type changed');
                    const selected = this.selectedOptions[0];
                    const periodeCout = periodeCoutSelect.value;
                    if (selected) {
                        document.getElementById('description').value = selected.getAttribute('data-description');
                        updateCostInput(selected, periodeCout);
                    }
                    updateRenewalDate(dateAchatInput.value, periodeCout);
                    checkFormValidity();
                });
                console.log('√âcouteur type attach√©.');
            } else { console.error('Erreur: √âl√©ment #type non trouv√©!'); }

            if (periodeCoutSelect) {
                periodeCoutSelect.addEventListener('change', function() {
                    console.log('√âv√©nement: PeriodeCout changed');
                    const selectedTypeOption = typeSelect.options.length > 0 ? typeSelect.selectedOptions[0] : null;
                    const currentPeriod = this.value;
                    updateCostInput(selectedTypeOption, currentPeriod);
                    updateRenewalDate(dateAchatInput.value, currentPeriod);
                    checkFormValidity();
                });
                console.log('√âcouteur periodeCout attach√©.');
            } else { console.error('Erreur: √âl√©ment #periodeCout non trouv√©!'); }

            if (dateAchatInput) {
                dateAchatInput.addEventListener('change', function() {
                    console.log('√âv√©nement: DateAchat changed');
                    const periodeCout = periodeCoutSelect.value;
                    updateRenewalDate(this.value, periodeCout);
                    checkFormValidity();
                });
                console.log('√âcouteur dateAchat attach√©.');
            } else { console.error('Erreur: √âl√©ment #dateAchat non trouv√©!'); }

            if (coutInput) {
                coutInput.addEventListener('input', function() {
                    console.log('√âv√©nement: Cout input');
                    checkFormValidity();
                    const coutValue = parseFloat(this.value.replace(',', '.'));
                    if (isNaN(coutValue) || coutValue <= 0) {
                        this.classList.add('cout-input-rouge');
                    } else {
                        this.classList.remove('cout-input-rouge');
                    }
                });
                coutInput.addEventListener('change', function() {
                    console.log('√âv√©nement: Cout changed');
                    const coutValue = parseFloat(this.value.replace(',', '.'));
                    if (isNaN(coutValue) || coutValue <= 0) {
                        this.classList.add('cout-input-rouge');
                    } else {
                        this.classList.remove('cout-input-rouge');
                    }
                });
                console.log('√âcouteur cout (input/change) attach√©.');
            } else { console.error('Erreur: √âl√©ment #cout non trouv√©!'); }


            if (licenseForm) {
                licenseForm.addEventListener('submit', function(event) {
                    console.log('√âv√©nement: Form submitted (Ajouter button clicked)');
                    event.preventDefault();

                    const pole = document.getElementById('pole').value;
                    const collaborateur = document.getElementById('collaborateur').value;
                    const licence = document.getElementById('licence').value;
                    const type = document.getElementById('type').value;
                    let coutValue = document.getElementById('cout').value.replace(',', '.');
                    const cout = parseFloat(coutValue);
                    const periodeCout = document.getElementById('periodeCout').value;
                    const dateAchat = document.getElementById('dateAchat').value;
                    const dateRenouvellementAffichee = document.getElementById('dateRenouvellement').value;

                    console.log('--- V√©rification des valeurs du formulaire pour Ajout ---');
                    console.log('  P√¥le:', pole, ' (Valid:', !!pole, ')');
                    console.log('  Collaborateur:', collaborateur, ' (Valid:', !!collaborateur, ')');
                    console.log('  Licence:', licence, ' (Valid:', !!licence, ')');
                    console.log('  Type:', type, ' (Valid:', !!type, ')');
                    console.log('  Co√ªt (parsed):', cout, ' (Valid: ', !isNaN(cout) && cout > 0, ')');
                    console.log('  P√©riode Co√ªt:', periodeCout, ' (Valid:', !!periodeCout, ')');
                    console.log('  Date Achat:', dateAchat, ' (Valid:', !!dateAchat, ')');
                    console.log('  Date Renouvellement Affichee:', dateRenouvellementAffichee);
                    console.log('----------------------------------------------------');

                    const isPoleSelected = pole !== "" && !document.getElementById('pole').options[document.getElementById('pole').selectedIndex].textContent.startsWith('-- S√©lectionner');
                    const isCollaborateurSelected = collaborateur !== "" && !document.getElementById('collaborateur').options[document.getElementById('collaborateur').selectedIndex].textContent.startsWith('-- S√©lectionner');
                    const isLicenceSelected = licence !== "" && !document.getElementById('licence').options[document.getElementById('licence').selectedIndex].textContent.startsWith('-- S√©lectionner');
                    const isTypeSelected = type !== "" && document.getElementById('type').options.length > 0 && !document.getElementById('type').options[document.getElementById('type').selectedIndex].textContent.startsWith('-- S√©lectionner');
                    const isPeriodeCoutSelected = periodeCout !== "" && !document.getElementById('periodeCout').options[document.getElementById('periodeCout').selectedIndex].textContent.startsWith('-- S√©lectionner');
                    const isCoutValid = !isNaN(cout) && cout > 0;
                    const isDateAchatValid = !!dateAchat;

                    const isValid = isPoleSelected && isCollaborateurSelected && isLicenceSelected && isTypeSelected && isCoutValid && isPeriodeCoutSelected && isDateAchatValid;

                    if (isValid) {
                        console.log('Condition de validit√© remplie. Ajout de la licence...');
                        const newLicence = {
                            pole,
                            collaborateur,
                            licence,
                            type,
                            cout,
                            periodeCout,
                            dateAchat,
                            dateRenouvellementAffichee,
                            url: typesParOutil[licence]?.find(item => item.type === type)?.url || typesParOutil[licence]?.[0]?.url || '#'
                        };

                        licencesData.push(newLicence);
                        saveLicences();
                        renderLicencesTable();
                        showToast('Licence ajout√©e avec succ√®s !', 'success');

                        document.getElementById('pole').value = '';
                        document.getElementById('collaborateur').value = '';
                        document.getElementById('licence').value = '';
                        document.getElementById('type').innerHTML = '';
                        document.getElementById('description').value = '';
                        document.getElementById('cout').value = '';
                        document.getElementById('periodeCout').value = '';
                        document.getElementById('dateAchat').value = '';
                        document.getElementById('dateRenouvellement').value = '';
                        updateTypes('');
                        updateCollaborators('');
                    } else {
                        console.warn('Condition de validit√© NON remplie. Affichage de l\'alerte.');
                        showToast("Veuillez remplir tous les champs obligatoires (P√¥le, Collaborateur, Licence, Type, Co√ªt, P√©riode du co√ªt, Date d'achat). Assurez-vous que le co√ªt est un nombre valide et non n√©gatif.", 'error');
                    }
                    checkFormValidity();
                });
                console.log('√âcouteur formulaire submit (Ajouter) attach√©.');
            } else { console.error('Erreur: √âl√©ment #licenseForm non trouv√©!'); }

            if (downloadButton) {
                downloadButton.addEventListener('click', function() {
                    console.log('√âv√©nement: T√©l√©charger la liste button clicked');
                    telecharger();
                });
                console.log('√âcouteur downloadButton attach√©.');
            } else { console.error('Erreur: √âl√©ment #downloadButton non trouv√©!'); }

            if (subscribeButton) {
                subscribeButton.addEventListener('click', function() {
                    console.log('√âv√©nement: Souscrire √† la Licence button clicked');
                    goToSubscriptionPage();
                });
                console.log('√âcouteur subscribeButton attach√©.');
            } else { console.error('Erreur: √âl√©ment #subscribeButton non trouv√©!'); }

            loadLicences();
            updateCollaborators(poleSelect.value || '');
            if (licenceSelect) {
                updateTypes(licenceSelect.value || '');
            }
            checkFormValidity();

            if (tablePoleFilter) {
                tablePoleFilter.addEventListener('change', filterTableByPole);
                console.log('√âcouteur tablePoleFilter attach√©.');
            } else { console.error('Erreur: √âl√©ment #tablePoleFilter non trouv√©!'); }

            const availablePoles = Object.keys(collaborateursParPole).sort();
            tablePoleFilter.innerHTML = '<option value="all">Tout</option>';
            availablePoles.forEach(pole => {
                const option = document.createElement('option');
                option.value = pole;
                option.textContent = pole;
                tablePoleFilter.appendChild(option);
            });
            filterTableByPole();
        });
    </script>
</body>
</html>
