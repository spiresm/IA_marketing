<!DOCTYPE html>
<html lang="fr">
<head>
Â  Â  <meta charset="UTF-8" />
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1" />
Â  Â  <title>Demande IA - Espace IA</title>
Â  Â  <style>
Â  Â  Â  Â  /* CSS INTÃ‰GRÃ‰ DIRECTEMENT ICI POUR ASSURER SA PRÃ‰SENCE */
Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  opacity: 0;
Â  Â  Â  Â  Â  Â  margin: 0;
Â  Â  Â  Â  Â  Â  font-family: sans-serif;
Â  Â  Â  Â  Â  Â  background-color: #f0f2f5;
Â  Â  Â  Â  Â  Â  transition: opacity 0.3s ease-in;
Â  Â  Â  Â  }
Â  Â  Â  Â  main {
Â  Â  Â  Â  Â  Â  display: none; /* Cache le contenu principal au chargement, le JS le rend visible */
Â  Â  Â  Â  }
Â  Â  Â  Â  .flex-wrapper {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  align-items: flex-start;
Â  Â  Â  Â  Â  Â  gap: 20px;
Â  Â  Â  Â  Â  Â  padding: 40px 20px;
Â  Â  Â  Â  Â  Â  flex-wrap: wrap;
Â  Â  Â  Â  }
Â  Â  Â  Â  .container {
Â  Â  Â  Â  Â  Â  flex: 1 1 600px;
Â  Â  Â  Â  Â  Â  max-width: 700px;
Â  Â  Â  Â  Â  Â  background: white;
Â  Â  Â  Â  Â  Â  padding: 40px 35px;
Â  Â  Â  Â  Â  Â  border-radius: 14px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.05);
Â  Â  Â  Â  }
Â  Â  Â  Â  form label {
Â  Â  Â  Â  Â  Â  display: block;
Â  Â  Â  Â  Â  Â  margin-top: 20px;
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  Â  Â  color: #444;
Â  Â  Â  Â  }
Â  Â  Â  Â  form input, form select, form textarea {
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  padding: 12px 14px;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  border: 1px solid #ccc;
Â  Â  Â  Â  Â  Â  font-size: 1em;
Â  Â  Â  Â  Â  Â  margin-top: 6px;
Â  Â  Â  Â  Â  Â  background-color: #f9fafb;
Â  Â  Â  Â  }
Â  Â  Â  Â  input[name="emailPrefix"], input[name="date"] {
Â  Â  Â  Â  Â  Â  max-width: 200px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .email-container {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  gap: 8px;
Â  Â  Â  Â  }
Â  Â  Â  Â  button {
Â  Â  Â  Â  Â  Â  background-color: #0077b6;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  padding: 10px 12px;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  font-size: 1em;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  margin-top: 15px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  transition: background-color 0.3s ease;
Â  Â  Â  Â  }
Â  Â  Â  Â  button:hover {
Â  Â  Â  Â  Â  Â  background-color: #005f8a;
Â  Â  Â  Â  }
Â  Â  Â  Â  button:disabled {
Â  Â  Â  Â  Â  Â  background-color: #a0a0a0;
Â  Â  Â  Â  Â  Â  cursor: not-allowed;
Â  Â  Â  Â  }
Â  Â  Â  Â  .recap {
Â  Â  Â  Â  Â  Â  flex: 0 1 320px;
Â  Â  Â  Â  Â  Â  background: rgb(0, 119, 182); /* Couleur de fond du rÃ©capitulatif */
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  Â  Â  border-radius: 14px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.05);
Â  Â  Â  Â  Â  Â  max-height: 90vh;
Â  Â  Â  Â  Â  Â  overflow-y: auto;
Â  Â  Â  Â  Â  Â  position: relative; /* Pour positionner le loading text */
Â  Â  Â  Â  }
Â  Â  Â  Â  .recap h3 {
Â  Â  Â  Â  Â  Â  margin-top: 0;
Â  Â  Â  Â  Â  Â  color: #ffffff; /* Texte en blanc */
Â  Â  Â  Â  Â  Â  margin-bottom: 10px;
Â  Â  Â  Â  }
Â  Â  Â  Â  #recapList {
Â  Â  Â  Â  Â  Â  margin-top: 20px;
Â  Â  Â  Â  Â  Â  min-height: 50px; /* Pour Ã©viter le saut quand les tickets chargent */
Â  Â  Â  Â  }
Â  Â  Â  Â  .ticket {
Â  Â  Â  Â  Â  Â  position: relative;
Â  Â  Â  Â  Â  Â  background: white;
Â  Â  Â  Â  Â  Â  padding: 12px 14px;
Â  Â  Â  Â  Â  Â  margin-bottom: 12px;
Â  Â  Â  Â  Â  Â  border-left: 4px solid #0077b6;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
Â  Â  Â  Â  Â  Â  font-size: 0.95em;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  flex-direction: column;
Â  Â  Â  Â  Â  Â  gap: 6px;
Â  Â  Â  Â  Â  Â  cursor: pointer; /* Indique que c'est cliquable */
Â  Â  Â  Â  }
Â  Â  Â  Â  .ticket span {
Â  Â  Â  Â  Â  Â  display: block;
Â  Â  Â  Â  Â  Â  line-height: 1.4em;
Â  Â  Â  Â  }
Â  Â  Â  Â  #modal {
Â  Â  Â  Â  Â  Â  position: fixed;
Â  Â  Â  Â  Â  Â  top: 0; left: 0; right: 0; bottom: 0;
Â  Â  Â  Â  Â  Â  background: rgba(0,0,0,0.4);
Â  Â  Â  Â  Â  Â  display: none;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  z-index: 1000;
Â  Â  Â  Â  }
Â  Â  Â  Â  .modal-content {
Â  Â  Â  Â  Â  Â  background: white;
Â  Â  Â  Â  Â  Â  border-radius: 12px;
Â  Â  Â  Â  Â  Â  padding: 25px 35px;
Â  Â  Â  Â  Â  Â  width: 90%;
Â  Â  Â  Â  Â  Â  max-width: 450px;
Â  Â  Â  Â  Â  Â  position: relative;
Â  Â  Â  Â  Â  Â  box-shadow: 0 8px 20px rgba(0,0,0,0.2);
Â  Â  Â  Â  Â  Â  font-size: 0.95em;
Â  Â  Â  Â  }
Â  Â  Â  Â  .close-modal {
Â  Â  Â  Â  Â  Â  position: absolute;
Â  Â  Â  Â  Â  Â  top: 10px;
Â  Â  Â  Â  Â  Â  right: 15px;
Â  Â  Â  Â  Â  Â  background: none;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  font-size: 1.5em;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  color: #666;
Â  Â  Â  Â  }
Â  Â  Â  Â  .modal-title {
Â  Â  Â  Â  Â  Â  color: #0077b6;
Â  Â  Â  Â  Â  Â  margin-top: 0;
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  Â  Â  font-size: 1.5em;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  }
Â  Â  Â  Â  .modal-info-line {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  margin-bottom: 10px;
Â  Â  Â  Â  Â  Â  line-height: 1.4;
Â  Â  Â  Â  Â  Â  flex-wrap: wrap;
Â  Â  Â  Â  }
Â  Â  Â  Â  .modal-info-line strong {
Â  Â  Â  Â  Â  Â  color: #0077b6;
Â  Â  Â  Â  Â  Â  min-width: 90px;
Â  Â  Â  Â  Â  Â  margin-right: 10px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .modal-info-line span {
Â  Â  Â  Â  Â  Â  flex: 1;
Â  Â  Â  Â  Â  Â  word-break: break-word;
Â  Â  Â  Â  }
Â  Â  Â  Â  .modal-info-line.description {
Â  Â  Â  Â  Â  Â  flex-direction: column;
Â  Â  Â  Â  }
Â  Â  Â  Â  .modal-info-line.description strong {
Â  Â  Â  Â  Â  Â  margin-bottom: 5px;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Styles pour la bulle de notification */
Â  Â  Â  Â  .notification-bubble {
Â  Â  Â  Â  Â  Â  position: absolute;
Â  Â  Â  Â  Â  Â  top: -5px;
Â  Â  Â  Â  Â  Â  right: -5px;
Â  Â  Â  Â  Â  Â  background-color: #ff0000;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  border-radius: 50%;
Â  Â  Â  Â  Â  Â  padding: 2px 7px;
Â  Â  Â  Â  Â  Â  font-size: 0.75em;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  display: none;
Â  Â  Â  Â  Â  Â  line-height: 1;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Styles pour les messages Toast */
Â  Â  Â  Â  #toast-container {
Â  Â  Â  Â  Â  Â  position: fixed;
Â  Â  Â  Â  Â  Â  bottom: 20px;
Â  Â  Â  Â  Â  Â  left: 50%;
Â  Â  Â  Â  Â  Â  transform: translateX(-50%);
Â  Â  Â  Â  Â  Â  z-index: 1000;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  flex-direction: column;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  pointer-events: none; /* Permet de cliquer Ã  travers */
Â  Â  Â  Â  }
Â  Â  Â  Â  .toast-message {
Â  Â  Â  Â  Â  Â  background-color: rgba(51, 51, 51, 0.9);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  padding: 10px 20px;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  margin-bottom: 10px;
Â  Â  Â  Â  Â  Â  opacity: 0;
Â  Â  Â  Â  Â  Â  transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
Â  Â  Â  Â  Â  Â  transform: translateY(20px);
Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 12px rgba(0,0,0,0.2);
Â  Â  Â  Â  Â  Â  min-width: 250px;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  }
Â  Â  Â  Â  .toast-message.show {
Â  Â  Â  Â  Â  Â  opacity: 1;
Â  Â  Â  Â  Â  Â  transform: translateY(0);
Â  Â  Â  Â  }
Â  Â  Â  Â  .toast-message.success {
Â  Â  Â  Â  Â  Â  background-color: rgba(40, 167, 69, 0.9); /* Vert */
Â  Â  Â  Â  }
Â  Â  Â  Â  .toast-message.error {
Â  Â  Â  Â  Â  Â  background-color: rgba(220, 53, 69, 0.9); /* Rouge */
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Styles pour l'Ã©tat de chargement des tickets */
Â  Â  Â  Â  .loading-text {
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  padding: 15px;
Â  Â  Â  Â  Â  Â  font-style: italic;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Styles pour la modale d'information */
Â  Â  Â  Â  #infoModal {
Â  Â  Â  Â  Â  Â  position: fixed;
Â  Â  Â  Â  Â  Â  top: 0;
Â  Â  Â  Â  Â  Â  left: 0;
Â  Â  Â  Â  Â  Â  right: 0;
Â  Â  Â  Â  Â  Â  bottom: 0;
Â  Â  Â  Â  Â  Â  background: rgba(0, 0, 0, 0.6); /* Fond sombre */
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  z-index: 2000; /* Assurez-vous qu'elle est au-dessus de tout le reste */
Â  Â  Â  Â  Â  Â  animation: fadeIn 0.3s ease-out;
Â  Â  Â  Â  }

Â  Â  Â  Â  #infoModal.hidden {
Â  Â  Â  Â  Â  Â  display: none;
Â  Â  Â  Â  }

Â  Â  Â  Â  .info-modal-content {
Â  Â  Â  Â  Â  Â  background: white;
Â  Â  Â  Â  Â  Â  border-radius: 12px;
Â  Â  Â  Â  Â  Â  padding: 30px 40px;
Â  Â  Â  Â  Â  Â  width: 90%;
Â  Â  Â  Â  Â  Â  max-width: 600px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  transform: scale(0.9);
Â  Â  Â  Â  Â  Â  animation: scaleIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
Â  Â  Â  Â  }

Â  Â  Â  Â  .info-modal-content h2 {
Â  Â  Â  Â  Â  Â  color: #0077b6;
Â  Â  Â  Â  Â  Â  margin-top: 0;
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  Â  Â  font-size: 1.8em;
Â  Â  Â  Â  }

Â  Â  Â  Â  .info-modal-content p {
Â  Â  Â  Â  Â  Â  font-size: 1.1em;
Â  Â  Â  Â  Â  Â  line-height: 1.6;
Â  Â  Â  Â  Â  Â  margin-bottom: 25px;
Â  Â  Â  Â  Â  Â  color: #333;
Â  Â  Â  Â  }

Â  Â  Â  Â  .info-modal-content p strong {
Â  Â  Â  Â  Â  Â  color: #0077b6; /* Pour le texte "type de contenu" */
Â  Â  Â  Â  }

Â  Â  Â  Â  .info-modal-content p em {
Â  Â  Â  Â  Â  Â  color: #e60000; /* Pour le texte "RTBF" */
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  font-style: normal;
Â  Â  Â  Â  }

Â  Â  Â  Â  .info-modal-content button {
Â  Â  Â  Â  Â  Â  background-color: #0077b6;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  padding: 12px 25px;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  font-size: 1.1em;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  transition: background-color 0.2s ease, transform 0.1s ease;
Â  Â  Â  Â  }

Â  Â  Â  Â  .info-modal-content button:hover {
Â  Â  Â  Â  Â  Â  background-color: #005f8a;
Â  Â  Â  Â  Â  Â  transform: translateY(-2px);
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Animations */
Â  Â  Â  Â  @keyframes fadeIn {
Â  Â  Â  Â  Â  Â  from { opacity: 0; }
Â  Â  Â  Â  Â  Â  to { opacity: 1; }
Â  Â  Â  Â  }

Â  Â  Â  Â  @keyframes scaleIn {
Â  Â  Â  Â  Â  Â  from { transform: scale(0.8); opacity: 0; }
Â  Â  Â  Â  Â  Â  to { transform: scale(1); opacity: 1; }
Â  Â  Â  Â  }
Â  Â  </style>
</head>
<body>
Â  Â  <div id="infoModal">
Â  Â  Â  Â  <div class="info-modal-content">
Â  Â  Â  Â  Â  Â  <h2>Bienvenue sur la page de Demande IA !</h2>
Â  Â  Â  Â  Â  Â  <p>Ce formulaire vous permet de soumettre vos demandes de productions basÃ©es sur l'Intelligence Artificielle. Remplissez les champs requis (votre nom, email, le type et le support de la demande, la chaÃ®ne, la durÃ©e souhaitÃ©e et un briefing dÃ©taillÃ©) pour que notre Ã©quipe puisse traiter votre requÃªte efficacement.</p>
Â  Â  Â  Â  Â  Â  <p>Sur la droite, vous trouverez un <strong>rÃ©capitulatif</strong> de toutes les demandes en cours et traitÃ©es, que vous pouvez filtrer par demandeur ou par chaÃ®ne. Vous pouvez Ã©galement marquer une demande comme traitÃ©e ou la supprimer si nÃ©cessaire.</p>
Â  Â  Â  Â  Â  Â  <button id="comprendaBtn">Compris !</button>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div id="header-placeholder"></div>

Â  Â  <main>
Â  Â  Â  Â  <div class="flex-wrapper">
Â  Â  Â  Â  Â  Â  <div class="container">
Â  Â  Â  Â  Â  Â  Â  Â  <h2 style="text-align:center; color:#0077b6; margin-top: 0;">Formulaire de demande de production IA</h2>
Â  Â  Â  Â  Â  Â  Â  Â  <form id="demandeIA">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label for="nom">Nom :</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" name="nom" required />

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label for="emailPrefix">Email :</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="email-container">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" name="emailPrefix" placeholder="initiales" required />
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span>@rtbf.be</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label for="type">Type :</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <select name="type" required>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="">-- SÃ©lectionner --</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="vidÃ©o">VidÃ©o</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="audio">Audio</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="image">Image</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="voix off IA">Voix off IA</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="formation">Formation</option> <option value="autre">Autre</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </select>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label for="support">Support :</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <select name="support" required>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="">-- SÃ©lectionner --</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="TV">TV</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Radio">Radio</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Web">Web</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="RS">RÃ©seaux sociaux</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="autre">Autre</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </select>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label for="chaine">Chaine :</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <select name="chaine" required>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="">-- SÃ©lectionner --</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="La Une">La Une</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Tipik">Tipik</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="La Trois">La Trois</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="La premiÃ¨re">La premiÃ¨re</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Classic 21">Classic 21</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="vivacitÃ©">vivacitÃ©</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Musiq3">Musiq3</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Auvio">Auvio</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Auvio Kids">Auvio Kids</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </select>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label for="duree">DurÃ©e :</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <select name="duree" id="duree"></select>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label for="date">Date :</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="date" name="date" required />

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label for="description">Briefing :</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <textarea name="description" rows="4" required></textarea>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button type="submit" id="submitBtn">Envoyer</button>
Â  Â  Â  Â  Â  Â  Â  Â  </form>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="recap">
Â  Â  Â  Â  Â  Â  Â  Â  <h3>RÃ©capitulatif des demandes</h3>
Â  Â  Â  Â  Â  Â  Â  Â  <select id="filtreDemandeur" style="width: 100%; padding: 8px; margin-bottom: 8px; border-radius: 6px; border: 1px solid #ccc;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="">Filtrer par demandeur</option>
Â  Â  Â  Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  Â  Â  Â  Â  <select id="filtreParChaine" style="width: 100%; padding: 8px; border-radius: 6px; border: 1px solid #ccc;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="">Filtrer par chaÃ®ne</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="recapList"></div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </main>

Â  Â  <div id="modal">
Â  Â  Â  Â  <div class="modal-content">
Â  Â  Â  Â  Â  Â  <button class="close-modal" title="Fermer">&times;</button>
Â  Â  Â  Â  Â  Â  <h4 class="modal-title">DÃ©tails de la demande</h4>
Â  Â  Â  Â  Â  Â  <div class="modal-body" id="modal-body">
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div id="toast-container"></div>

Â  Â  <script>
Â  Â  Â  Â  // DÃ©finitions des URL pour les fonctions Netlify
Â  Â  Â  Â  const PROXY_URL = "/.netlify/functions/proxy";
Â  Â  Â  Â  const SEND_REQUEST_URL = "/.netlify/functions/sendrequest";

Â  Â  Â  Â  // Fonction pour s'assurer que le parent de la bulle de notification a une position relative
Â  Â  Â  Â  function ensureNotifParentPosition() {
Â  Â  Â  Â  Â  Â  const demandeLink = document.querySelector("a.demandes");
Â  Â  Â  Â  Â  Â  if (demandeLink) {
Â  Â  Â  Â  Â  Â  Â  Â  const style = getComputedStyle(demandeLink);
Â  Â  Â  Â  Â  Â  Â  Â  if (style.position === "static" || !style.position) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  demandeLink.style.position = "relative";
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  // Fonction pour afficher un message toast
Â  Â  Â  Â  function showToast(message, type = 'info') {
Â  Â  Â  Â  Â  Â  const toastContainer = document.getElementById('toast-container');
Â  Â  Â  Â  Â  Â  const toast = document.createElement('div');
Â  Â  Â  Â  Â  Â  toast.className = `toast-message ${type}`;
Â  Â  Â  Â  Â  Â  toast.textContent = message;
Â  Â  Â  Â  Â  Â  toastContainer.appendChild(toast);

Â  Â  Â  Â  Â  Â  // Force reflow pour l'animation
Â  Â  Â  Â  Â  Â  void toast.offsetWidth;Â 
Â  Â  Â  Â  Â  Â  toast.classList.add('show');

Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  toast.classList.remove('show');
Â  Â  Â  Â  Â  Â  Â  Â  toast.addEventListener('transitionend', () => toast.remove(), { once: true });
Â  Â  Â  Â  Â  Â  }, 3000); // DisparaÃ®t aprÃ¨s 3 secondes
Â  Â  Â  Â  }

Â  Â  Â  Â  // Chargement de l'en-tÃªte
Â  Â  Â  Â  fetch("header.html")
Â  Â  Â  Â  Â  Â  .then(res => {
Â  Â  Â  Â  Â  Â  Â  Â  if (!res.ok) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.error('Erreur lors du chargement de header.html:', res.status, res.statusText);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById("header-placeholder").innerHTML = '<p style="color: red;">Erreur: header.html non trouvÃ© ou inaccessible.</p>';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  showToast('Erreur de chargement de l\'en-tÃªte.', 'error');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  throw new Error('header.html not found');
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  return res.text();
Â  Â  Â  Â  Â  Â  })
Â  Â  Â  Â  Â  Â  .then(data => {
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById("header-placeholder").innerHTML = data;
Â  Â  Â  Â  Â  Â  Â  Â  ensureNotifParentPosition();
Â  Â  Â  Â  Â  Â  Â  Â  document.body.style.opacity = "1";
Â  Â  Â  Â  Â  Â  Â  Â  document.querySelector("main").style.display = "block";
Â  Â  Â  Â  Â  Â  Â  Â  mettreAJourBulleDemandes();
Â  Â  Â  Â  Â  Â  })
Â  Â  Â  Â  Â  Â  .catch(error => {
Â  Â  Â  Â  Â  Â  Â  Â  console.error("Ã‰chec du chargement de l'en-tÃªte:", error);
Â  Â  Â  Â  Â  Â  Â  Â  document.body.style.opacity = "1";
Â  Â  Â  Â  Â  Â  Â  Â  document.querySelector("main").style.display = "block";
Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  const couleursParChaine = {
Â  Â  Â  Â  Â  Â  'Classic 21': 'purple',
Â  Â  Â  Â  Â  Â  'La Une': 'red',
Â  Â  Â  Â  Â  Â  'Tipik': 'green',
Â  Â  Â  Â  Â  Â  'La Trois': 'mediumorchid',
Â  Â  Â  Â  Â  Â  'La premiÃ¨re': 'blue',
Â  Â  Â  Â  Â  Â  'Auvio': 'black',
Â  Â  Â  Â  Â  Â  'vivacitÃ©': 'orange',
Â  Â  Â  Â  Â  Â  'Musiq3': 'hotpink',
Â  Â  Â  Â  Â  Â  'Auvio Kids': 'pink' // CHANGEMENT ICI : de 'navy' Ã  'pink'
Â  Â  Â  Â  };

Â  Â  Â  Â  async function mettreAJourBulleDemandes() {
Â  Â  Â  Â  Â  Â  const notif = document.getElementById("notif-count");
Â  Â  Â  Â  Â  Â  if (!notif) {
Â  Â  Â  Â  Â  Â  Â  Â  console.warn("Ã‰lÃ©ment 'notif-count' non trouvÃ©. Assurez-vous qu'il est dans header.html.");
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const res = await fetch(`${PROXY_URL}?action=getDemandesIA`);
Â  Â  Â  Â  Â  Â  Â  Â  if (!res.ok) throw new Error(`HTTP error! status: ${res.status}`);
Â  Â  Â  Â  Â  Â  Â  Â  const responseData = await res.json();
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  const demandes = responseData.data;Â 
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  const demandesNonTraitees = demandes.filter(d => !d.traite);
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  notif.textContent = demandesNonTraitees.length;
Â  Â  Â  Â  Â  Â  Â  Â  notif.style.display = demandesNonTraitees.length > 0 ? "inline-block" : "none";
Â  Â  Â  Â  Â  Â  } catch (e) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error("Erreur lors de la rÃ©cupÃ©ration du compteur de demandes :", e);
Â  Â  Â  Â  Â  Â  Â  Â  notif.style.display = "none";
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  async function afficherDemandes() {
Â  Â  Â  Â  Â  Â  const recapList = document.getElementById("recapList");
Â  Â  Â  Â  Â  Â  const filtreDemandeurSelect = document.getElementById("filtreDemandeur");
Â  Â  Â  Â  Â  Â  const filtreParChaineSelect = document.getElementById("filtreParChaine");Â 

Â  Â  Â  Â  Â  Â  recapList.innerHTML = '<p class="loading-text">Chargement des demandes...</p>';Â 

Â  Â  Â  Â  Â  Â  let demandes = [];
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const res = await fetch(`${PROXY_URL}?action=getDemandesIA`);
Â  Â  Â  Â  Â  Â  Â  Â  if (!res.ok) throw new Error(`HTTP error! status: ${res.status}`);
Â  Â  Â  Â  Â  Â  Â  Â  const responseData = await res.json();

Â  Â  Â  Â  Â  Â  Â  Â  if (responseData.success && Array.isArray(responseData.data)) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  demandes = responseData.data;
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  throw new Error("La rÃ©ponse de l'API n'est pas un tableau valide.");
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  } catch (err) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error("Erreur lors de la rÃ©cupÃ©ration des demandes :", err);
Â  Â  Â  Â  Â  Â  Â  Â  recapList.innerHTML = '<p style="color: red; text-align: center;">Erreur lors du chargement des demandes. VÃ©rifiez la console.</p>';
Â  Â  Â  Â  Â  Â  Â  Â  showToast('Erreur lors du chargement des demandes.', 'error');
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  // Peupler le filtre "Demandeur"
Â  Â  Â  Â  Â  Â  const demandeursUniques = [...new Set(demandes.map(d => d.nom).filter(Boolean))].sort();
Â  Â  Â  Â  Â  Â  filtreDemandeurSelect.innerHTML = '<option value="">Filtrer par demandeur</option>';
Â  Â  Â  Â  Â  Â  demandeursUniques.forEach(nom => {Â 
Â  Â  Â  Â  Â  Â  Â  Â  const option = document.createElement('option');
Â  Â  Â  Â  Â  Â  Â  Â  option.value = nom;
Â  Â  Â  Â  Â  Â  Â  Â  option.textContent = nom;
Â  Â  Â  Â  Â  Â  Â  Â  filtreDemandeurSelect.appendChild(option);
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  const currentFiltreDemandeur = filtreDemandeurSelect.dataset.currentValue || '';
Â  Â  Â  Â  Â  Â  if (currentFiltreDemandeur) {
Â  Â  Â  Â  Â  Â  Â  Â  filtreDemandeurSelect.value = currentFiltreDemandeur;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  // Peupler le filtre par chaÃ®ne (liste complÃ¨te des options de chaÃ®ne)
Â  Â  Â  Â  Â  Â  const chainesDisponibles = [
Â  Â  Â  Â  Â  Â  Â  Â  "La Une", "Tipik", "La Trois", "La premiÃ¨re", "Classic 21", "vivacitÃ©", "Musiq3", "Auvio", "Auvio Kids"
Â  Â  Â  Â  Â  Â  ].sort();

Â  Â  Â  Â  Â  Â  filtreParChaineSelect.innerHTML = '<option value="">Filtrer par chaÃ®ne</option>';
Â  Â  Â  Â  Â  Â  chainesDisponibles.forEach(chaine => {
Â  Â  Â  Â  Â  Â  Â  Â  const option = document.createElement('option');
Â  Â  Â  Â  Â  Â  Â  Â  option.value = chaine;
Â  Â  Â  Â  Â  Â  Â  Â  option.textContent = chaine;
Â  Â  Â  Â  Â  Â  Â  Â  filtreParChaineSelect.appendChild(option);
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  const currentFiltreParChaine = filtreParChaineSelect.dataset.currentValue || '';
Â  Â  Â  Â  Â  Â  if (currentFiltreParChaine) {
Â  Â  Â  Â  Â  Â  Â  Â  filtreParChaineSelect.value = currentFiltreParChaine;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const selectedFiltreDemandeur = filtreDemandeurSelect.value;
Â  Â  Â  Â  Â  Â  const selectedFiltreParChaine = filtreParChaineSelect.value;Â 

Â  Â  Â  Â  Â  Â  let demandesFiltrees = demandes;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Appliquer le filtre par demandeur
Â  Â  Â  Â  Â  Â  if (selectedFiltreDemandeur) {
Â  Â  Â  Â  Â  Â  Â  Â  demandesFiltrees = demandesFiltrees.filter(d => d.nom === selectedFiltreDemandeur);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Appliquer le filtre par chaÃ®neÂ 
Â  Â  Â  Â  Â  Â  if (selectedFiltreParChaine) {
Â  Â  Â  Â  Â  Â  Â  Â  demandesFiltrees = demandesFiltrees.filter(d => d.chaine === selectedFiltreParChaine);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  // Tri par date du plus rÃ©cent au plus ancien, aprÃ¨s filtrage
Â  Â  Â  Â  Â  Â  demandesFiltrees.sort((a, b) => new Date(b.date) - new Date(a.date));


Â  Â  Â  Â  Â  Â  recapList.innerHTML = "";Â 

Â  Â  Â  Â  Â  Â  if (demandesFiltrees.length === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  recapList.innerHTML = '<p style="text-align: center; color: #777;">Aucune demande trouvÃ©e avec ces critÃ¨res.</p>';
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  demandesFiltrees.forEach(d => {
Â  Â  Â  Â  Â  Â  Â  Â  const couleur = couleursParChaine[d.chaine] || "#0077b6";
Â  Â  Â  Â  Â  Â  Â  Â  const div = document.createElement("div");
Â  Â  Â  Â  Â  Â  Â  Â  div.className = "ticket";
Â  Â  Â  Â  Â  Â  Â  Â  div.style.borderLeftColor = couleur;
Â  Â  Â  Â  Â  Â  Â  Â  div.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="display:flex; justify-content: space-between; align-items:center">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span><strong>${d.nom || 'N/A'}</strong></span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="display:flex; align-items:center; gap:12px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span style="font-size:1.1em; font-weight: bold;">${d.type || 'N/A'}</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span>${d.duree || 'N/A'}</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 4px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span style="color:${couleur}; font-weight: bold">${d.chaine || 'N/A'}</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <small style="color:#666;">ğŸ“… ${d.date ? new Date(d.date).toLocaleDateString('fr-BE') : 'N/A'}</small>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="display:flex; justify-content: space-between; align-items: center; margin-top: 6px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div>${d.traite ? '<span style="color:green">âœ… TraitÃ©</span>' : '<span style="color:#999">â³ En attente</span>'}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${d.traite ? '' : `<button title="Marquer comme traitÃ©" data-id="${d.id}" class="btn-traite" style="background:none; border:none; font-size:1.1em; cursor:pointer; padding:4px;">âœ”ï¸</button>`}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button title="Supprimer" data-id="${d.id}" class="btn-supprimer" style="background:none; border:none; font-size:1.1em; cursor:pointer; padding:4px;">ğŸ—‘ï¸</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  `;

Â  Â  Â  Â  Â  Â  Â  Â  div.querySelector(".btn-supprimer")?.addEventListener("click", async e => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  e.stopPropagation();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (confirm("ÃŠtes-vous sÃ»r de vouloir supprimer cette demande ?")) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  await supprimerDemande(d.id);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  Â  Â  div.querySelector(".btn-traite")?.addEventListener("click", async e => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  e.stopPropagation();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  await marquerTraite(d.id);
Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  Â  Â  div.addEventListener("click", () => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const modal = document.getElementById("modal");
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const modalBody = document.getElementById("modal-body");
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const formattedDate = d.date ? new Date(d.date).toLocaleDateString('fr-BE', { year: 'numeric', month: 'long', day: 'numeric' }) : 'N/A';

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  modalBody.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="modal-info-line"><strong>Nom :</strong> <span>${d.nom || 'N/A'}</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="modal-info-line"><strong>Email :</strong> <span>${d.email || 'N/A'}</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="modal-info-line"><strong>Type :</strong> <span>${d.type || 'N/A'}</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="modal-info-line"><strong>Support :</strong> <span>${d.support || 'N/A'}</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="modal-info-line"><strong>ChaÃ®ne :</strong> <span>${d.chaine || 'N/A'}</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="modal-info-line"><strong>DurÃ©e :</strong> <span>${d.duree || 'N/A'}</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="modal-info-line"><strong>Date :</strong> <span>${formattedDate}</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="modal-info-line description"><strong>Briefing :</strong> <span>${d.description || 'N/A'}</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  modal.style.display = "flex";
Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  Â  Â  recapList.appendChild(div);
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }

Â  Â  Â  Â  async function supprimerDemande(id) {
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const response = await fetch(PROXY_URL, {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  method: "POST",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  headers: { "Content-Type": "application/json" },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  body: JSON.stringify({ action: "deleteDemande", id: id })
Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  Â  Â  const result = await response.json();

Â  Â  Â  Â  Â  Â  Â  Â  if (result.success) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  showToast(result.message || "Demande supprimÃ©e avec succÃ¨s !", 'success');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  afficherDemandes();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  mettreAJourBulleDemandes();
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.error("Ã‰chec de la suppression (rÃ©ponse backend) :", result.message);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  showToast(`Ã‰chec de la suppression : ${result.message || "Erreur inconnue."}`, 'error');
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  } catch(e) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error("Erreur lors de la suppression de la demande cÃ´tÃ© client :", e);
Â  Â  Â  Â  Â  Â  Â  Â  showToast("Erreur lors de la suppression. VÃ©rifiez la console pour plus de dÃ©tails.", 'error');
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  async function marquerTraite(id) {
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const response = await fetch(PROXY_URL, {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  method: "POST",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  headers: { "Content-Type": "application/json" },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  body: JSON.stringify({
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  action: "updateDemandeIA",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  id: id,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  traite: trueÂ 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  })
Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  Â  Â  const updateResult = await response.json();
Â  Â  Â  Â  Â  Â  Â  Â  if (updateResult.success) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  showToast(updateResult.message || "Demande marquÃ©e comme traitÃ©e avec succÃ¨s !", 'success');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  afficherDemandes();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  mettreAJourBulleDemandes();
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.error("Erreur lors de la mise Ã  jour du statut (rÃ©ponse backend) :", updateResult.message);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  showToast(`Ã‰chec de la mise Ã  jour : ${updateResult.message || "Erreur inconnue."}`, 'error');
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  } catch(e) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error("Erreur lors du marquage comme traitÃ© :", e);
Â  Â  Â  Â  Â  Â  Â  Â  showToast("Erreur lors du marquage. Voir la console pour plus de dÃ©tails.", 'error');
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  // Ã‰vÃ©nements DOMContentLoaded
Â  Â  Â  Â  document.addEventListener("DOMContentLoaded", () => {
Â  Â  Â  Â  Â  Â  // Remplir le select des durÃ©es
Â  Â  Â  Â  Â  Â  const dureeSelect = document.getElementById("duree");
Â  Â  Â  Â  Â  Â  for (let i = 0; i <= 60; i++) {
Â  Â  Â  Â  Â  Â  Â  Â  const opt = document.createElement("option");
Â  Â  Â  Â  Â  Â  Â  Â  opt.value = `${i} sec`;
Â  Â  Â  Â  Â  Â  Â  Â  opt.textContent = `${i} sec`;
Â  Â  Â  Â  Â  Â  Â  Â  dureeSelect.appendChild(opt);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  const defaultOptDuree = document.createElement("option");
Â  Â  Â  Â  Â  Â  defaultOptDuree.value = "";
Â  Â  Â  Â  Â  Â  defaultOptDuree.textContent = "-- SÃ©lectionner --";
Â  Â  Â  Â  Â  Â  dureeSelect.prepend(defaultOptDuree);
Â  Â  Â  Â  Â  Â  dureeSelect.value = "";Â 

Â  Â  Â  Â  Â  Â  // Gestion de la soumission du formulaire
Â  Â  Â  Â  Â  Â  document.getElementById("demandeIA").addEventListener("submit", async e => {
Â  Â  Â  Â  Â  Â  Â  Â  e.preventDefault();
Â  Â  Â  Â  Â  Â  Â  Â  const data = new FormData(e.target);
Â  Â  Â  Â  Â  Â  Â  Â  const demande = {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  id: "_" + Math.random().toString(36).substr(2, 9),Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  nom: data.get("nom"),
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  email: `${data.get("emailPrefix")}@rtbf.be`,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  type: data.get("type"),
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  support: data.get("support"),
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  duree: data.get("duree"),
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  date: data.get("date"),
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  description: data.get("description"),
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  chaine: data.get("chaine"),
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  traite: falseÂ 
Â  Â  Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  Â  Â  const submitBtn = document.getElementById("submitBtn");
Â  Â  Â  Â  Â  Â  Â  Â  const originalBtnText = submitBtn.textContent;
Â  Â  Â  Â  Â  Â  Â  Â  submitBtn.textContent = "Envoi en cours...";
Â  Â  Â  Â  Â  Â  Â  Â  submitBtn.disabled = true;

Â  Â  Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const response = await fetch(SEND_REQUEST_URL, {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  method: "POST",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  headers: { "Content-Type": "application/json" },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  body: JSON.stringify(demande)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (!response.ok) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const errorText = await response.text();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.error(`Erreur HTTP: ${response.status} ${response.statusText}`, errorText);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  showToast(`Erreur lors de l'envoi de la demande: ${response.status} ${response.statusText}.`, 'error');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const result = await response.json();

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (result.success) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  showToast(result.message || "Demande envoyÃ©e avec succÃ¨s et mail transmis !", 'success');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  e.target.reset();Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  afficherDemandes();Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  mettreAJourBulleDemandes();Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.error("Erreur de la fonction Netlify (rÃ©ponse JSON) :", result);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  showToast(`Erreur lors de l'envoi de la demande: ${result.message || "RÃ©ponse non rÃ©ussie de la fonction Netlify."}`, 'error');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  } catch (err) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.error("Erreur d'envoi du formulaire cÃ´tÃ© client :", err);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  showToast("Une erreur inattendue est survenue lors de l'envoi du formulaire. VÃ©rifiez la console.", 'error');
Â  Â  Â  Â  Â  Â  Â  Â  } finally {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  submitBtn.textContent = originalBtnText;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  submitBtn.disabled = false;
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  // Ã‰couteurs d'Ã©vÃ©nements pour les filtres
Â  Â  Â  Â  Â  Â  const filtreDemandeurSelect = document.getElementById("filtreDemandeur");
            const filtreParChaineSelect = document.getElementById("filtreParChaine");

            filtreDemandeurSelect.addEventListener('change', () => {
                filtreDemandeurSelect.dataset.currentValue = filtreDemandeurSelect.value;
                afficherDemandes();
            });

            filtreParChaineSelect.addEventListener('change', () => {
                filtreParChaineSelect.dataset.currentValue = filtreParChaineSelect.value;
                afficherDemandes();
            });

Â  Â  Â  Â  Â  Â  afficherDemandes(); // Appel initial pour afficher les demandes au chargement
Â  Â  Â  Â  Â  Â  document.getElementById("comprendaBtn").addEventListener("click", () => {
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById("infoModal").classList.add("hidden");
Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  document.querySelector(".close-modal").addEventListener("click", () => {
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById("modal").style.display = "none";
Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  window.addEventListener("click", (event) => {
Â  Â  Â  Â  Â  Â  Â  Â  const modal = document.getElementById("modal");
Â  Â  Â  Â  Â  Â  Â  Â  if (event.target == modal) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  modal.style.display = "none";
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  });
Â  Â  </script>
</body>
</html>
