<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Accueil - Espace IA</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* CSS COMPLET ET FINAL */
        :root {
            --primary-blue: #0077b6;
            --dark-blue: #005f8a;
            --light-blue: #64B5F6;
            --background-grey: #f0f2f5;
            --card-shadow: 0 4px 15px rgba(0,0,0,0.08);
            --grey-text: #555;
            --border-color: #ccc;
            --error-text: #dc3545;
        }
        body {
            font-family: 'Segoe UI', 'Inter', sans-serif;
            margin: 0;
            background-color: var(--background-grey);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        main {
            padding: 40px 20px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            gap: 30px;
        }
        .nav-wrapper {
            background-color: var(--primary-blue);
            width: 100%;
            position: relative;
            flex-shrink: 0;
            padding: 5px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .menu-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 30px;
            box-sizing: border-box;
        }
        nav { display: flex; justify-content: center; align-items: center; flex-wrap: wrap; }
        nav a { text-decoration: none; color: white; font-weight: bold; font-size: 1.1em; padding: 10px 18px; border-radius: 8px; transition: background 0.3s ease; margin: 0 5px; white-space: nowrap; position: relative; }
        nav a:hover, nav a.active { background-color: white; color: var(--primary-blue); }
        .notif-bubble { position: absolute; top: 0px; right: 0px; background: red; color: white; border-radius: 50%; padding: 2px 6px; font-size: 12px; font-weight: bold; display: none; }
        
        .content-section { max-width: 960px; width: 100%; margin: 0 auto; padding: 25px; box-sizing: border-box; background-color: #fff; border-radius: 12px; box-shadow: var(--card-shadow); position: relative; }
        .content-section h2 { text-align: center; color: var(--dark-blue); margin-top: 0; margin-bottom: 25px; }

        /* --- STYLES CARROUSEL VEILLE --- */
        .veille-section-container { padding: 0; background: none; box-shadow: none; max-width: 100%; }
        
        .veille-header {
            max-width: 960px;
            margin: 0 auto 15px auto;
            position: relative;
            padding-top: 15px;
        }
        .veille-header h3 {
             text-align: center;
             color: var(--dark-blue);
             margin: 0;
        }
        .post-it-note {
            position: absolute;
            top: 0;
            right: -25px;
            background-color: #fffbdd;
            padding: 15px;
            border-radius: 4px;
            box-shadow: 3px 3px 8px rgba(0,0,0,0.15);
            z-index: 101;
            max-width: 230px;
            display: flex;
            align-items: flex-start;
            gap: 10px;
            border-left: 5px solid #ffeb3b;
            transform: rotate(3deg) translateZ(0);
        }
        .post-it-note .post-it-icon {
            font-size: 1.5em;
            color: var(--primary-blue);
            margin-top: 2px;
        }
        .post-it-note p { margin: 0; font-size: 0.9em; color: #5c5c5c; line-height: 1.4; }
        .post-it-note strong { color: #333; display: block; margin-bottom: 4px; }

        .veille-carousel-wrapper { max-width: 960px; margin: 0 auto; position: relative; }
        .veille-scroll-container { width: 100%; overflow: hidden; border-radius: 12px; background: #fff; }
        .veille-grid {
            display: flex;
            transition: transform 0.5s ease-in-out;
        }
        .veille-card {
            flex: 0 0 100%;
            box-sizing: border-box;
            padding: 30px 70px;
            display: flex;
            flex-direction: column;
            min-height: 320px;
        }
        .veille-card .card-meta-info { display: flex; flex-wrap: wrap; gap: 15px; margin-bottom: 15px; font-size: 0.9em; color: var(--grey-text); }
        .veille-card .meta-tag { display: flex; align-items: center; gap: 6px; background-color: #f0f2f5; padding: 5px 10px; border-radius: 15px; }
        .veille-card h4 { text-align: left; font-size: 1.6em; color: var(--dark-blue); margin: 0 0 10px 0; }
        .veille-card .card-content { text-align: left; flex-grow: 1; }
        .veille-card .card-content p { font-size: 1.05em; line-height: 1.6; margin: 0; color: var(--grey-text); }
        .veille-card .card-footer { margin-top: 25px; }
        .veille-card .view-article-button { display: inline-block; padding: 12px 22px; background-color: var(--primary-blue); color: white; text-decoration: none; border-radius: 8px; font-weight: bold; transition: background-color 0.2s, transform 0.2s; }
        .veille-card .view-article-button:hover { background-color: var(--dark-blue); transform: translateY(-2px); }
        
        .scroll-arrow { background-color: rgba(255, 255, 255, 0.9); color: var(--primary-blue); border: 1px solid #ddd; width: 45px; height: 45px; cursor: pointer; border-radius: 50%; font-size: 1.4em; position: absolute; top: 50%; transform: translateY(-50%); z-index: 100; box-shadow: 0 2px 8px rgba(0,0,0,0.15); transition: all 0.2s ease; display: flex; align-items: center; justify-content: center; }
        .scroll-arrow:hover { background-color: var(--primary-blue); color: white; transform: translateY(-50%) scale(1.1); }
        .scroll-arrow.left { left: 15px; }
        .scroll-arrow.right { right: 15px; }
        .scroll-arrow:disabled { opacity: 0.4; cursor: not-allowed; transform: translateY(-50%); background-color: #e9ecef; color: #6c757d; border-color: #ced4da; }

        /* --- AUTRES SECTIONS --- */
        .news-ticker-section { display: flex; align-items: center; position: relative; }
        .news-ticker-container { flex-grow: 1; overflow: hidden; margin-right: 15px; }
        .news-ticker-content { display: flex; white-space: nowrap; animation: ticker 40s linear infinite; }
        .news-item .author-info { font-style: italic; font-size: 0.85em; }
        @keyframes ticker { from { transform: translateX(100%); } to { transform: translateX(-100%); } }
        .message-button { background-color: var(--primary-blue); color: white; padding: 8px 15px; border: none; border-radius: 8px; font-size: 0.9em; font-weight: bold; text-decoration: none; white-space: nowrap; transition: background-color 0.2s ease; flex-shrink: 0; }
        .message-button:hover { background-color: var(--dark-blue); }
        .latest-additions-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px; }
        .addition-card { background: #fff; border-radius: 12px; box-shadow: var(--card-shadow); display: flex; flex-direction: column; transition: transform 0.2s ease, box-shadow 0.2s ease; overflow: hidden; }
        .addition-card:hover { transform: translateY(-5px); box-shadow: 0 8px 25px rgba(0,0,0,0.12); }
        .card-content-wrapper { padding: 20px; flex-grow: 1; display: flex; flex-direction: column; }
        .card-top-meta { display: flex; justify-content: flex-end; width: 100%; margin-bottom: 10px; }
        .addition-card h4 { font-size: 1.1em; color: var(--grey-text); margin: 0 0 5px 0; font-weight: normal; text-align: left;}
        .addition-card .card-subtitle { font-size: 1.2em; font-weight: bold; color: #333; margin-bottom: 15px; text-align: left;}
        .addition-card .card-image-container { width: 100%; padding-bottom: 56.25%; position: relative; overflow: hidden; border-radius: 8px; margin-bottom: 15px; background-color: #eee; }
        .addition-card .card-image-container img { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; }
        .addition-card .card-meta { display: flex; flex-direction: column; gap: 8px; font-size: 0.9em; color: var(--grey-text); flex-grow: 1; margin-bottom: 15px; }
        .addition-card .meta-line { display: flex; align-items: center; gap: 8px; text-align: left; }
        .addition-card .view-button { display: block; text-align: center; margin-top: auto; padding: 10px 15px; background-color: var(--primary-blue); color: white; text-decoration: none; border-radius: 8px; font-weight: bold; transition: background-color 0.2s; }
        .addition-card .view-button:hover { background-color: var(--dark-blue); }
        .outil-badge { background-color: #e9ecef; color: #495057; font-size: 0.8em; padding: 5px 12px; border-radius: 15px; }
        footer { background-color: #333; color: white; text-align: center; padding: 20px; margin-top: auto; width: 100%; }

        /* --- RESPONSIVE --- */
        @media (max-width: 768px) {
            main { padding: 20px 0; }
            .content-section { border-radius: 0; }
            nav { justify-content: flex-start; overflow-x: auto; padding-bottom: 10px; }
            .veille-header { padding: 15px 15px 0 15px; }
            .post-it-note { position: static; transform: none; margin: 15px auto 0 auto; max-width: 90%; }
            .scroll-arrow { display: none; }
            .veille-carousel-wrapper { width: 100%; }
            .veille-scroll-container {
                 overflow-x: auto;
                 scroll-snap-type: x mandatory;
                 border-radius: 0;
            }
            .veille-card {
                scroll-snap-align: center;
                width: 90%;
                flex: 0 0 90%;
                padding: 25px;
            }
            .veille-grid { gap: 15px; padding: 0 5%; transform: none !important; }
        }
    </style>
</head>
<body>

    <div class="nav-wrapper">
        <div class="menu-container">
             <nav>
                <a href="index.html" class="active">Accueil</a>
                <a href="equipe.html">Équipe</a>
                <a href="outils.html">Outils</a>
                <a href="galerie.html">Prompts</a>
                <a href="cas-usages.html">Workflows</a>
                <a href="charte.html">Chartes</a>
                <a href="faq.html">FAQ</a>
                <a href="demandes_ia.html">Demandes<span class="notif-bubble" id="notif-count">0</span></a>
                <a href="gestion-license.html">Licenses</a>
             </nav>
        </div>
    </div>

    <main>
        <section class="veille-section-container">
            <div class="veille-header">
                <h3>Veille IA & Marketing</h3>
                <div class="post-it-note">
                    <i class="fas fa-robot post-it-icon"></i>
                    <p>
                        <strong>Veille Automatisée</strong>
                        Générée par un workflow n8n et diffusée en newsletter.
                    </p>
                </div>
            </div>
            
            <div class="veille-carousel-wrapper">
                <div class="veille-scroll-container">
                    <div id="veille-articles-grid" class="veille-grid">

      <div class="veille-card">
          <div class="card-meta-info">
              <span class="meta-tag"><i class="fas fa-calendar-alt"></i> 5 juillet 2025</span>
              <span class="meta-tag"><i class="fas fa-newspaper"></i> Veille Automatisée</span>
              <span class="meta-tag"><i class="fas fa-tag"></i> Actualité</span>
          </div>
          <h4>⚡ Microsoft pousse au passage à Windows 11</h4>
          <div class="card-content"><p>Microsoft cherche à motiver les utilisateurs de Windows 10 à adopter Windows 11 en avançant huit arguments en faveur de cette transition. L'éditeur de logiciels souhaite ainsi favoriser l'adoption de sa nouvelle version du système d'exploitation, mettant en avant ses nouvelles fonctionnalités et ses améliorations.</p></div>
          <div class="card-footer">
              <a href="https://www.lesnumeriques.com/ordinateur-portable/windows-11-voici-les-8-raisons-de-quitter-windows-10-des-maintenant-selon-microsoft-n238625.html" target="_blank" rel="noopener noreferrer" class="view-article-button">Lire l’article</a>
          </div>
      </div>

      <div class="veille-card">
          <div class="card-meta-info">
              <span class="meta-tag"><i class="fas fa-calendar-alt"></i> 5 juillet 2025</span>
              <span class="meta-tag"><i class="fas fa-newspaper"></i> Veille Automatisée</span>
              <span class="meta-tag"><i class="fas fa-tag"></i> Actualité</span>
          </div>
          <h4>⚡ Apple doit être plus transparente sur l'IA</h4>
          <div class="card-content"><p>Apple doit apporter plus de transparence sur les capacités réelles de son Intelligence Artificielle (IA). L'entreprise mise désormais sur l'IA pour enrichir ses appareils, mais des questions demeurent quant à la performance de ces nouvelles fonctionnalités.</p></div>
          <div class="card-footer">
              <a href="https://www.begeek.fr/pour-ameliorer-apple-intelligence-apple-doit-dabord-etre-transparent-sur-ses-capacites-reelles-416611" target="_blank" rel="noopener noreferrer" class="view-article-button">Lire l’article</a>
          </div>
      </div>

      <div class="veille-card">
          <div class="card-meta-info">
              <span class="meta-tag"><i class="fas fa-calendar-alt"></i> 5 juillet 2025</span>
              <span class="meta-tag"><i class="fas fa-newspaper"></i> Veille Automatisée</span>
              <span class="meta-tag"><i class="fas fa-tag"></i> Actualité</span>
          </div>
          <h4>⚡ Les outils publicitaires de Reddit grâce à l'IA</h4>
          <div class="card-content"><p>Reddit propose de nouveaux outils publicitaires basés sur l'Intelligence Artificielle pour aider les marques à comprendre les attentes des utilisateurs à leur égard. L'outil "Reddit Community Intelligence" fournit des informations précieuses pour mieux adapter leurs stratégies marketing.</p></div>
          <div class="card-footer">
              <a href="https://www.zdnet.fr/actualites/comment-les-nouveaux-outils-publicitaires-ia-de-reddit-aident-les-marques-a-rejoindre-la-conversation-477513.htm" target="_blank" rel="noopener noreferrer" class="view-article-button">Lire l’article</a>
          </div>
      </div>

      <div class="veille-card">
          <div class="card-meta-info">
              <span class="meta-tag"><i class="fas fa-calendar-alt"></i> 5 juillet 2025</span>
              <span class="meta-tag"><i class="fas fa-newspaper"></i> Veille Automatisée</span>
              <span class="meta-tag"><i class="fas fa-tag"></i> Actualité</span>
          </div>
          <h4>⚡ Meta et son nouveau montage vidéo par IA</h4>
          <div class="card-content"><p>Meta lance "Restyle", un nouvel outil de montage vidéo propulsé par l'Intelligence Artificielle. L'outil promet de transformer les clips d'un simple clic grâce à des filtres prédéfinis. Toutefois, les premiers tests montrent des résultats pour le moins inattendus et parfois décevants.</p></div>
          <div class="card-footer">
              <a href="https://www.generation-nt.com/actualites/meta-ia-video-montage-restyle-instagram-2058970" target="_blank" rel="noopener noreferrer" class="view-article-button">Lire l’article</a>
          </div>
      </div>

      <div class="veille-card">
          <div class="card-meta-info">
              <span class="meta-tag"><i class="fas fa-calendar-alt"></i> 5 juillet 2025</span>
              <span class="meta-tag"><i class="fas fa-newspaper"></i> Veille Automatisée</span>
              <span class="meta-tag"><i class="fas fa-tag"></i> Actualité</span>
          </div>
          <h4>⚡ Décryptage d'une prétendue fuite massive de mots de passe</h4>
          <div class="card-content"><p>L'annonce d'une fuite prétendue de 16 milliards de mots de passe en juin 2025 a créé un vent de panique à niveau mondial. Les experts dénoncent un "marketing de la peur", incitant à la vigilance extrême des utilisateurs quant à la protection de leurs informations.</p></div>
          <div class="card-footer">
              <a href="https://www.numerama.com/cyberguerre/1996181-on-est-dans-le-marketing-de-la-peur-des-experts-decryptent-la-fausse-fuite-inedite-de-16-milliards-didentifiants.html" target="_blank" rel="noopener noreferrer" class="view-article-button">Lire l’article</a>
          </div>
      </div>

</div>
          <h4>⚡ Les arguments de Microsoft pour encourager la transition vers Windows 11</h4>
          <div class="card-content"><p>Microsoft met en avant huit raisons pour encourager les utilisateurs de Windows 10 à passer à Windows 11. Cet article de Les Numeriques détaille les arguments de Microsoft pour inciter les utilisateurs à adopter le nouveau système d'exploitation, dont une interface utilisateur améliorée, une meilleure sécurité et de nouvelles fonctionnalités de productivité.</p></div>
          <div class="card-footer">
              <a href="https://www.lesnumeriques.com/ordinateur-portable/windows-11-voici-les-8-raisons-de-quitter-windows-10-des-maintenant-selon-microsoft-n238625.html" target="_blank" rel="noopener noreferrer" class="view-article-button">Lire l’article</a>
          </div>
      </div>
    
      <div class="veille-card">
          <div class="card-meta-info">
              <span class="meta-tag"><i class="fas fa-calendar-alt"></i> 5 juillet 2025</span>
              <span class="meta-tag"><i class="fas fa-newspaper"></i> Veille Automatisée</span>
              <span class="meta-tag"><i class="fas fa-tag"></i> Actualité</span>
          </div>
          <h4>⚡ Transparence sur l'intelligence artificielle d'Apple : un enjeu de confiance</h4>
          <div class="card-content"><p>L'intégration de l'intelligence artificielle dans les appareils Apple soulève des questions sur la réelle performance de ces fonctionnalités. Selon cet article de Begeek, il est impératif pour Apple d'offrir une visibilité sur les capacités et les limites de ses outils basés sur l'IA pour rassurer les utilisateurs et améliorer la perception de ses produits.</p></div>
          <div class="card-footer">
              <a href="https://www.begeek.fr/pour-ameliorer-apple-intelligence-apple-doit-dabord-etre-transparent-sur-ses-capacites-reelles-416611" target="_blank" rel="noopener noreferrer" class="view-article-button">Lire l’article</a>
          </div>
      </div>
    
      <div class="veille-card">
          <div class="card-meta-info">
              <span class="meta-tag"><i class="fas fa-calendar-alt"></i> 5 juillet 2025</span>
              <span class="meta-tag"><i class="fas fa-newspaper"></i> Veille Automatisée</span>
              <span class="meta-tag"><i class="fas fa-tag"></i> Actualité</span>
          </div>
          <h4>⚡ Les outils publicitaires IA de Reddit et leur apport pour les marques</h4>
          <div class="card-content"><p>Reddit Community Intelligence, les nouveaux outils publicitaires de Reddit, fournit des informations précieuses aux entreprises souhaitant connaître les opinions des utilisateurs sur leurs marques. Selon un article de Zdnet, ces outils basés sur l'IA aident les marques à se connecter aux discussions sur Reddit et à mieux comprendre la perception du public à leur égard.</p></div>
          <div class="card-footer">
              <a href="https://www.zdnet.fr/actualites/comment-les-nouveaux-outils-publicitaires-ia-de-reddit-aident-les-marques-a-rejoindre-la-conversation-477513.htm" target="_blank" rel="noopener noreferrer" class="view-article-button">Lire l’article</a>
          </div>
      </div>
    
      <div class="veille-card">
          <div class="card-meta-info">
              <span class="meta-tag"><i class="fas fa-calendar-alt"></i> 5 juillet 2025</span>
              <span class="meta-tag"><i class="fas fa-newspaper"></i> Veille Automatisée</span>
              <span class="meta-tag"><i class="fas fa-tag"></i> Actualité</span>
          </div>
          <h4>⚡ Meta et son outil de montage vidéo par IA : une déception ?</h4>
          <div class="card-content"><p>Meta a déployé Restyle, son nouvel outil de montage vidéo basé sur l'intelligence artificielle. Pais cet article de Generation NT détaille des résultats qui sont loin des attentes, avec des clips transformés via des filtres prédéfinis produisant des résultats décevants et parfois étranges.</p></div>
          <div class="card-footer">
              <a href="https://www.generation-nt.com/actualites/meta-ia-video-montage-restyle-instagram-2058970" target="_blank" rel="noopener noreferrer" class="view-article-button">Lire l’article</a>
          </div>
      </div>
    
      <div class="veille-card">
          <div class="card-meta-info">
              <span class="meta-tag"><i class="fas fa-calendar-alt"></i> 5 juillet 2025</span>
              <span class="meta-tag"><i class="fas fa-newspaper"></i> Veille Automatisée</span>
              <span class="meta-tag"><i class="fas fa-tag"></i> Actualité</span>
          </div>
          <h4>⚡ Retour sur la prétendue fuite de 16 milliards de mots de passe</h4>
          <div class="card-content"><p>La récente rumeur de fuite de 16 milliards de mots de passe a créé une onde de choc. Cet article de Numerama dénonce une pratique de "marketing de la peur" qui vise à attiser l'anxiété pour pousser à l'utilisation de services de protection. Il met en évidence l'importance de la vérification des faits avant de céder à la panique.</p></div>
          <div class="card-footer">
              <a href="https://www.numerama.com/cyberguerre/1996181-on-est-dans-le-marketing-de-la-peur-des-experts-decryptent-la-fausse-fuite-inedite-de-16-milliards-didentifiants.html" target="_blank" rel="noopener noreferrer" class="view-article-button">Lire l’article</a>
          </div>
      </div>
    
</div>
                </div>
                <button class="scroll-arrow left" id="veille-scroll-left"><i class="fas fa-chevron-left"></i></button>
                <button class="scroll-arrow right" id="veille-scroll-right"><i class="fas fa-chevron-right"></i></button>
            </div>
        </section>

        <section class="news-ticker-section content-section">
            <i class="fas fa-newspaper icon"></i>
            <div class="news-ticker-container"><div class="news-ticker-content" id="newsTickerContent"></div></div>
            <a href="admin-news.html" class="message-button">Laisser un message</a>
        </section>

        <div class="content-section">
            <h2>Derniers ajouts</h2>
            <div id="latest-additions-grid" class="latest-additions-grid"></div>
        </div>
    </main>
    
    <footer id="footer-placeholder"><p>&copy; 2025 Espace IA. Tous droits réservés.</p></footer>

    <script>
    document.addEventListener("DOMContentLoaded", () => {
    
        // =========================================================================
        // SECTION 1 : CARROUSEL DE VEILLE (CHARGEMENT DYNAMIQUE)
        // =========================================================================

        async function loadAndInitVeille() {
            const grid = document.getElementById('veille-articles-grid');
            if (!grid) return;

            try {
                const response = await fetch('veille-articles.json');
                if (!response.ok) throw new Error(`Fichier de veille introuvable (statut: ${response.status})`);
                
                const articles = await response.json();

                if (!articles || articles.length === 0) {
                    grid.innerHTML = '<p style="padding: 20px; text-align: center;">Aucun article de veille à afficher.</p>';
                    document.getElementById('veille-scroll-left').style.display = 'none';
                    document.getElementById('veille-scroll-right').style.display = 'none';
                    return;
                }

                grid.innerHTML = articles.map(article => `
                    <div class="veille-card">
                        <div class="card-meta-info">
                            <span class="meta-tag"><i class="fas fa-calendar-alt"></i> ${article.date || 'Date'}</span>
                            <span class="meta-tag"><i class="fas fa-newspaper"></i> ${article.source || 'Source'}</span>
                            <span class="meta-tag"><i class="fas fa-tag"></i> ${article.tag || 'Tag'}</span>
                        </div>
                        <h4>⚡ ${article.titre || 'Titre non disponible'}</h4>
                        <div class="card-content"><p>${article.resume || 'Résumé non disponible.'}</p></div>
                        <div class="card-footer">
                            <a href="${article.url || '#'}" target="_blank" rel="noopener noreferrer" class="view-article-button">Lire l’article</a>
                        </div>
                    </div>
                `).join('');

                initVeilleCarousel();

            } catch (error) {
                console.error("Erreur de chargement de la veille:", error);
                grid.innerHTML = `<p style="padding: 20px; text-align: center; color: var(--error-text);">Impossible de charger les articles de veille.</p>`;
            }
        }

        function initVeilleCarousel() {
            const grid = document.getElementById('veille-articles-grid');
            const prevButton = document.getElementById('veille-scroll-left');
            const nextButton = document.getElementById('veille-scroll-right');
            const scrollContainer = grid.parentElement;

            if (!grid || !prevButton || !nextButton || !scrollContainer) return;
            
            const cards = grid.querySelectorAll('.veille-card');
            if (cards.length <= 1) {
                prevButton.style.display = 'none';
                nextButton.style.display = 'none';
                return;
            } else {
                prevButton.style.display = 'flex';
                nextButton.style.display = 'flex';
            }

            let currentIndex = 0;

            const updateCarousel = () => {
                const offset = -currentIndex * scrollContainer.clientWidth;
                grid.style.transform = `translateX(${offset}px)`;
                prevButton.disabled = currentIndex === 0;
                nextButton.disabled = currentIndex >= cards.length - 1;
            };

            nextButton.addEventListener('click', () => {
                if (currentIndex < cards.length - 1) { currentIndex++; updateCarousel(); }
            });

            prevButton.addEventListener('click', () => {
                if (currentIndex > 0) { currentIndex--; updateCarousel(); }
            });

            window.addEventListener('resize', () => {
                if (window.innerWidth > 768) {
                    grid.style.transition = 'none'; 
                    updateCarousel();
                    setTimeout(() => { grid.style.transition = 'transform 0.5s ease-in-out'; }, 50);
                } else {
                    grid.style.transform = 'none';
                }
            });

            if (window.innerWidth > 768) updateCarousel();
        };
        
        // =========================================================================
        // SECTION 2 : FONCTIONS UTILITAIRES ET "DERNIERS AJOUTS"
        // =========================================================================
        
        const escapeHtml = (text) => {
            if (text === null || text === undefined) return '';
            const map = { '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#039;' };
            return String(text).replace(/[&<>"']/g, m => map[m]);
        };

        const getYouTubeVideoId = (url) => {
            if (!url) return null;
            const match = url.match(/(?:youtube\.com\/(?:[^\/\n\s]+\/\S+\/|(?:v|e(?:mbed)?)\/|\S*?[?&]v=)|youtu\.be\/)([a-zA-Z0-9_-]{11})/);
            return match ? match[1] : null;
        };
        
        const formatteDate = (dateString) => {
            if (!dateString) return 'Date inconnue';
            try { return new Date(dateString).toLocaleDateString('fr-FR', { year: 'numeric', month: 'long', day: 'numeric' }); } 
            catch (e) { return 'Date invalide'; }
        };

        const createCard = (item, type) => {
            const card = document.createElement("div");
            card.className = 'addition-card';
            const mainCardTitle = type === 'galerie' ? 'Dernier prompt partagé' : 'Dernier workflow partagé';
            let mediaHtml = '';
            const youtubeVideoId = getYouTubeVideoId(item.firstVideoUrl);

            if (youtubeVideoId) {
                mediaHtml = `<div class="card-image-container"><img src="https://i.ytimg.com/vi/${youtubeVideoId}/hqdefault.jpg" alt="Vignette pour ${escapeHtml(item.titre)}"></div>`;
            } else if (item.imageUrl && item.imageUrl !== 'NO_IMAGE_PLACEHOLDER') {
                mediaHtml = `<div class="card-image-container"><img src="${escapeHtml(item.imageUrl)}" alt="Vignette pour ${escapeHtml(item.titre)}"></div>`;
            }
            
            const toolBadge = item.outil && item.outil !== 'Non spécifié' ? `<span class="outil-badge">${escapeHtml(item.outil)}</span>` : '';
            card.innerHTML = `<div class="card-content-wrapper"><div class="card-top-meta">${toolBadge}</div><h4>${mainCardTitle}</h4><div class="card-subtitle">${escapeHtml(item.titre)}</div>${mediaHtml}<div class="card-meta"><span class="meta-line"><strong>Auteur:</strong> ${escapeHtml(item.auteur)}</span><span class="meta-line"><strong>Créé le:</strong> ${formatteDate(item.date)}</span></div><a href="${type === 'cas-usage' ? 'cas-usages.html' : 'galerie.html'}" class="view-button">Voir plus</a></div>`;
            return card;
        };

        async function displayLatestAdditions() {
            const container = document.getElementById("latest-additions-grid");
            if (!container) return;
            container.innerHTML = '<p>Chargement des contenus...</p>';

            const GET_TIPS_URL = "/.netlify/functions/get-tips";
            const GET_PROMPTS_URL = "/.netlify/functions/getGalleryPrompts";

            try {
                const [tipsResponse, promptsResponse] = await Promise.all([
                    fetch(GET_TIPS_URL).catch(e => ({ok: false, json: () => Promise.resolve([])})),
                    fetch(GET_PROMPTS_URL).catch(e => ({ok: false, json: () => Promise.resolve([])}))
                ]);

                let tips = tipsResponse.ok ? await tipsResponse.json() : [];
                let prompts = promptsResponse.ok ? await promptsResponse.json() : [];

                const normalizeItem = (item) => ({...item, titre: item.titre || "Titre non spécifié", auteur: item.auteur || "Auteur inconnu", date: item.date_creation || item.dateCreation, chaine: item.chaine || "Non spécifié", outil: item.outil || "Non spécifié", imageUrl: item.imageUrl || (Array.isArray(item.fileUrls) && item.fileUrls.length > 0 ? item.fileUrls[0] : 'NO_IMAGE_PLACEHOLDER'), firstVideoUrl: (Array.isArray(item.urls) ? item.urls : []).find(url => getYouTubeVideoId(url))});
                
                tips = tips.map(normalizeItem).sort((a, b) => new Date(b.date) - new Date(a.date));
                prompts = prompts.map(normalizeItem).sort((a, b) => new Date(b.date) - new Date(a.date));

                container.innerHTML = '';
                let itemsToDisplay = [];
                if (prompts.length > 0) itemsToDisplay.push({ item: prompts[0], type: 'galerie' });
                if (tips.length > 0) itemsToDisplay.push({ item: tips[0], type: 'cas-usage' });

                if (itemsToDisplay.length > 0) {
                    itemsToDisplay.forEach(({ item, type }) => container.appendChild(createCard(item, type)));
                } else {
                    container.innerHTML = '<p>Aucun ajout récent à afficher.</p>';
                }
            } catch (error) {
                container.innerHTML = `<p style="color: var(--error-text);">Erreur de chargement des contenus.</p>`;
            }
        }

        // =========================================================================
        // SECTION 3 : BANDEAU D'ACTUALITÉS
        // =========================================================================
        async function loadNewsTicker() {
            const newsTickerContent = document.getElementById('newsTickerContent');
            if (!newsTickerContent) return;
            const NEWS_DATA_PATH = 'news-data.json';
            try {
                const response = await fetch(NEWS_DATA_PATH);
                if (!response.ok) throw new Error('Fichier news introuvable.');
                const newsItems = await response.json();

                if (newsItems.length > 0) {
                    const fullTextHtml = newsItems.map(item => {
                        let fullText = escapeHtml(item.title);
                        if (item.collaborateur && item.collaborateur !== 'Non spécifié') {
                            fullText += `<span class="author-info"> (${escapeHtml(item.collaborateur)})</span>`;
                        }
                        return `<span class="news-item" style="color: ${item.color || '#333'};">${fullText}</span>`;
                    }).join(' &nbsp; • &nbsp; ');
                    newsTickerContent.innerHTML = fullTextHtml + ' &nbsp; • &nbsp; ' + fullTextHtml;
                } else {
                    newsTickerContent.innerHTML = '<span>Aucune actualité pour le moment.</span>';
                }
            } catch (error) {
                newsTickerContent.innerHTML = '<span>Impossible de charger les actualités.</span>';
            }
        }
        
        // =========================================================================
        // SECTION 4 : LOGIQUE DU MENU ACTIF
        // =========================================================================
        function setActiveNavLink() {
            const currentPath = window.location.pathname.split('/').pop() || "index.html";
            document.querySelectorAll('nav a').forEach(link => {
                const linkHref = new URL(link.href, window.location.origin).pathname.split('/').pop();
                if (linkHref === currentPath) {
                    link.classList.add("active");
                } else {
                    link.classList.remove("active");
                }
            });
        }

        // =========================================================================
        // APPEL DE TOUTES LES FONCTIONS AU CHARGEMENT DE LA PAGE
        // =========================================================================
        loadAndInitVeille();
        displayLatestAdditions();
        loadNewsTicker();
        setActiveNavLink();
    });
    </script>

</body>
</html>
