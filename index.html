<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Accueil - Espace IA</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    body {
      opacity: 0;
      transition: opacity 0.3s ease-in;
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: #f2f4f8;
    }

    .section {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 30px;
      padding: 40px 20px;
    }

    .tile {
      background-color: #ffffff;
      width: 100%;
      max-width: 900px;
      border-left: 8px solid #0077b6;
      border-radius: 10px;
      padding: 30px;
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.05);
      text-align: center;
    }

    .tile h2 {
      margin-top: 0;
      color: #0077b6;
    }

    .tile p {
      color: #555;
      line-height: 1.6;
    }

    .btn {
      background: #0077b6;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
    }

    .quick-start {
      text-align: center;
      margin-top: 30px;
    }

    .quick-start h3 {
      color: #0077b6;
      font-size: 1.5rem;
      margin-bottom: 20px;
    }

    .quick-buttons {
      display: flex;
      justify-content: center;
      gap: 20px;
      flex-wrap: wrap;
    }

    .quick-btn {
      background-color: #0077b6;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      font-size: 1rem;
      cursor: pointer;
      transition: background-color 0.3s, transform 0.2s;
    }

    .quick-btn:hover {
      background-color: #005f8c;
      transform: scale(1.05);
    }

    .chatgpt-wrapper {
      display: flex;
      justify-content: center;
      margin-top: 50px;
    }

    .chatgpt-box {
      width: 100%;
      max-width: 650px;
      background: #ffffff;
      border: 1px solid #dee2e6;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 119, 182, 0.1);
      display: flex;
      flex-direction: column;
      gap: 16px;
      padding: 24px;
    }

    .chatgpt-box h3 {
      margin: 0;
      font-size: 1.2rem;
      text-align: center;
      color: #333;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .chatgpt-box h3::before {
      content: "üí¨";
      font-size: 1.2rem;
    }

    .chatgpt-box textarea {
      width: 100%;
      padding: 14px;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 1rem;
      resize: vertical;
      font-family: inherit;
    }

    .chatgpt-box .btn {
      align-self: center;
      padding: 12px 30px;
      background-color: #0077b6;
      color: #fff;
      font-weight: bold;
      font-size: 1rem;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      transition: background-color 0.2s ease;
    }

    .chatgpt-box .btn:hover {
      background-color: #005f8c;
    }

    #reponse {
      white-space: pre-wrap;
      background: #f4faff;
      padding: 14px;
      border-radius: 8px;
      border: 1px solid #cce5ff;
      font-size: 0.95rem;
      line-height: 1.4;
      color: #333;
    }
  </style>
</head>
<body>
  <div id="header-placeholder"></div>

  <div class="section">
    <div class="tile">
      <h2>Bienvenue sur l‚Äôespace IA Marketing</h2>
      <p>
        Cette plateforme collaborative vous permet de d√©couvrir, partager et capitaliser sur les usages de l‚Äôintelligence artificielle au sein de notre organisation. Que vous cherchiez des outils, des prompts, des cas d‚Äôusage inspirants ou que vous souhaitiez contribuer avec vos propres astuces, tout est centralis√© ici pour accompagner votre mont√©e en comp√©tence et faciliter l‚Äôadoption de l‚ÄôIA au quotidien.
      </p>

      <div class="quick-start">
        <h3>Commencez d√®s maintenant</h3>
        <div class="quick-buttons">
          <button class="quick-btn" onclick="location.href='decouvrir.html'">üß≠ D√©couvrir</button>
          <button class="quick-btn" onclick="location.href='archiver.html'">üóÇÔ∏è Archiver</button>
          <button class="quick-btn" onclick="location.href='apprendre.html'">üìò Apprendre</button>
        </div>
      </div>

      <div class="chatgpt-wrapper">
        <div class="chatgpt-box">
          <h3>Discuter avec ChatGPT</h3>
          <textarea id="user-input" rows="4" placeholder="Pose ta question ici..."></textarea>
          <button class="btn" onclick="envoyer()">Envoyer</button>
          <pre id="reponse"></pre>
        </div>
      </div>
    </div>
  </div>

  <script>
    function mettreAJourBulleDemandes() {
      const notif = document.getElementById("notif-count");
      if (!notif) return;
      const demandes = JSON.parse(localStorage.getItem("demandesIA") || "[]");
      notif.textContent = demandes.length;
      notif.style.display = demandes.length > 0 ? "inline-block" : "none";
    }

    fetch("header.html")
      .then(res => res.text())
      .then(data => {
        document.getElementById("header-placeholder").innerHTML = data;
      })
      .catch(() => {
        document.getElementById("header-placeholder").innerHTML =
          "<p style='color:white;text-align:center'>Erreur de chargement du menu</p>";
      })
      .finally(() => {
        document.body.style.opacity = "1";
        mettreAJourBulleDemandes();
      });

    async function envoyer() {
      const userMessage = document.getElementById("user-input").value;

      const response = await fetch("/.netlify/functions/chat-clean", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ message: userMessage })
      });

      const text = await response.text();
      let data;

      try {
        data = JSON.parse(text);
      } catch (e) {
        document.getElementById("reponse").textContent = "‚ùå Erreur : r√©ponse non JSON\n" + text;
        return;
      }

      if (data.error) {
        document.getElementById("reponse").textContent = `‚ùå Erreur API : ${data.error}`;
      } else {
        document.getElementById("reponse").textContent = data.reply || "‚úÖ Pas de r√©ponse g√©n√©r√©e.";
      }
    }
  </script>
</body>
</html>
