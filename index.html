<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Accueil - Espace IA Marketing</title>
    <link rel="stylesheet" href="style.css" />
    <style>
        /* CSS sp√©cifique au loader et au corps de page */
        #loader {
            position: fixed;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.98); /* Fond blanc quasi opaque pour le chargement */
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2.5em;
            font-family: Arial, sans-serif;
            color: #0077b6; /* Couleur du texte du loader */
            z-index: 9999; /* Assure que le loader est au-dessus de tout */
            opacity: 1; /* Initialement visible */
            transition: opacity 0.5s ease-out; /* Transition douce pour la disparition */
        }

        #loader.hidden {
            opacity: 0; /* Rend le loader transparent */
            pointer-events: none; /* Emp√™che les clics sur l'√©l√©ment transparent */
        }

        /* Styles g√©n√©raux du body et du layout */
        body {
            margin: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; /* Police plus moderne */
            background-color: #eef2f7; /* Couleur de fond l√©g√®rement ajust√©e */
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            color: #333; /* Couleur de texte par d√©faut */
        }

        .main-content {
            flex-grow: 1;
            padding: 40px 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 40px; /* Espacement entre les sections */
        }

        .section {
            width: 100%;
            max-width: 960px; /* Largeur maximale pour un bon confort de lecture */
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
        }

        .tile {
            background-color: #ffffff;
            width: 100%;
            border-left: 8px solid #0077b6;
            border-radius: 12px; /* Rayon de bordure l√©g√®rement plus prononc√© */
            padding: 30px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08); /* Ombre plus douce et plus pr√©sente */
            text-align: center;
        }

        .tile h2, .tile h3 {
            margin-top: 0;
            color: #0077b6;
            font-weight: 600; /* Gras un peu plus l√©ger pour les titres */
        }

        .tile p {
            color: #555;
            line-height: 1.7; /* Hauteur de ligne am√©lior√©e pour la lecture */
            font-size: 1.05rem;
        }

        /* Styles sp√©cifiques au Hero Section */
        .hero-section .tile {
            border-left: none; /* Pas de bordure pour la section hero */
            padding: 50px 30px;
            background: linear-gradient(135deg, #e0f2f7 0%, #ffffff 100%); /* Fond d√©grad√© */
            box-shadow: 0 10px 30px rgba(0, 119, 182, 0.15); /* Ombre plus prononc√©e pour le hero */
            max-width: 1000px;
        }

        .hero-section h2 {
            font-size: 2.8em; /* Taille plus grande pour le titre principal */
            margin-bottom: 15px;
            color: #004d77; /* Couleur de titre plus fonc√©e */
        }

        .hero-section p {
            font-size: 1.2em;
            margin-bottom: 30px;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
            color: #444;
        }

        /* CSS pour le bloc ChatGPT */
        .chatgpt-wrapper {
            display: flex;
            justify-content: center;
            width: 100%; /* S'assure que le wrapper prend toute la largeur disponible */
        }
        .chatgpt-box {
            width: 100%;
            max-width: 700px; /* Agrandit l√©g√®rement le bloc chat */
            background: #ffffff;
            border: 1px solid #dee2e6;
            border-radius: 16px; /* Bordures plus douces */
            box-shadow: 0 6px 18px rgba(0, 119, 182, 0.15); /* Ombre plus √©l√©gante */
            display: flex;
            flex-direction: column;
            gap: 20px; /* Espacement accru entre les √©l√©ments */
            padding: 30px;
            align-items: center;
        }
        .chatgpt-box h3 {
            margin: 0;
            font-size: 1.4rem; /* Titre plus grand */
            text-align: center;
            color: #0077b6;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .chatgpt-box h3::before {
            content: "üí¨";
            font-size: 1.4rem;
        }
        .chatgpt-box textarea {
            width: 100%;
            max-width: 600px; /* Largeur du textarea augment√©e */
            margin: 0 auto;
            padding: 16px;
            border-radius: 10px; /* Bordures plus douces */
            border: 1px solid #bbb; /* Bordure l√©g√®rement plus fonc√©e */
            font-size: 1.1rem; /* Texte plus grand dans le textarea */
            resize: vertical;
            font-family: inherit;
            min-height: 100px; /* Hauteur minimale du textarea */
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.05); /* Petite ombre interne */
        }
        .chatgpt-box .btn {
            padding: 14px 35px; /* Bouton plus grand */
            background-color: #0077b6;
            color: #fff;
            font-weight: bold;
            font-size: 1.1rem; /* Texte du bouton plus grand */
            border-radius: 10px; /* Bordures plus douces */
            border: none;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease; /* Transition pour l'effet de pression */
            letter-spacing: 0.5px;
        }
        .chatgpt-box .btn:hover {
            background-color: #005f8c;
            transform: translateY(-2px); /* L√©ger effet de soul√®vement au survol */
        }
        .chatgpt-box .btn:active {
            transform: translateY(0); /* Effet de pression au clic */
        }
        #reponse {
            white-space: pre-wrap;
            background: #f4faff;
            padding: 20px; /* Padding augment√© */
            border-radius: 10px;
            border: 1px solid #cce5ff;
            font-size: 1rem; /* Taille de police l√©g√®rement augment√©e */
            line-height: 1.5;
            color: #333;
            max-width: 600px; /* Largeur augment√©e pour la r√©ponse */
            margin: 0 auto;
            text-align: left; /* Alignement du texte √† gauche pour la r√©ponse */
            min-height: 80px; /* Hauteur minimale pour la zone de r√©ponse */
            display: flex; /* Utilisation de flexbox pour centrer le texte verticalement si court */
            align-items: center;
            justify-content: center;
        }

        /* Styles pour la section des fonctionnalit√©s (Features) */
        .features-section {
            display: grid; /* Utilisation de Grid pour un meilleur agencement des tuiles */
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); /* Tuiles adaptatives */
            gap: 30px; /* Espacement entre les tuiles */
            width: 100%;
            max-width: 960px;
        }

        .feature-tile {
            border-left: 8px solid #00a8e8; /* Couleur de bordure diff√©rente pour les tuiles de fonctionnalit√©s */
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .feature-tile:hover {
            transform: translateY(-5px); /* L√©ger effet de soul√®vement au survol */
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .feature-tile h3 {
            color: #00a8e8;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        /* Ajoutez des ic√¥nes pour les titres de tuiles de fonctionnalit√©s si vous voulez */
        .feature-tile h3::before {
            /* Exemple d'ic√¥ne, √† adapter si vous utilisez Font Awesome ou des images */
            content: "üí°"; /* Exemple: &#128161; (ampoule) */
            font-size: 1.3em;
            color: #00a8e8;
        }
        .feature-tile:nth-child(2) h3::before { content: "üõ†Ô∏è"; } /* Outils */
        .feature-tile:nth-child(3) h3::before { content: "üìö"; } /* Ressources */


        .feature-tile .secondary-cta {
            background-color: #00a8e8; /* Couleur diff√©rente pour les CTA secondaires */
            padding: 10px 25px;
            font-size: 0.95rem;
            margin-top: 20px;
        }

        .feature-tile .secondary-cta:hover {
            background-color: #008fbf;
        }

        /* Style pour le footer */
        .footer {
            text-align: center;
            padding: 25px;
            color: #777;
            font-size: 0.9rem;
            margin-top: auto;
            background-color: #f8f8f8; /* Fond l√©g√®rement diff√©rent pour le footer */
            border-top: 1px solid #eee;
        }

        /* Media Queries pour la r√©activit√© */
        @media (max-width: 768px) {
            .hero-section h2 {
                font-size: 2em;
            }
            .hero-section p {
                font-size: 1em;
            }
            .chatgpt-box {
                padding: 20px;
            }
            .chatgpt-box textarea, #reponse {
                font-size: 0.95rem;
            }
            .chatgpt-box .btn {
                font-size: 1rem;
                padding: 12px 25px;
            }
            .features-section {
                grid-template-columns: 1fr; /* Une seule colonne sur petits √©crans */
            }
        }
    </style>
</head>
<body>
    <div id="loader">
        Chargement de l'Espace IA...
    </div>

    <div id="header-placeholder"></div>

    <main class="main-content">
        <section class="section hero-section">
            <div class="tile hero-tile">
                <h2>Votre Hub pour l'Innovation IA Marketing</h2>
                <p>D√©couvrez, partagez et ma√Ætrisez les usages de l'intelligence artificielle pour transformer votre strat√©gie marketing et maximiser votre impact.</p>
                <button class="btn primary-cta">Explorer nos Ressources IA</button>
            </div>
        </section>

        <section class="section chat-section">
            <div class="chatgpt-wrapper">
                <div class="chatgpt-box">
                    <h3>üí¨ Demandez √† votre assistant IA marketing</h3>
                    <textarea id="user-input" rows="4" placeholder="Ex: G√©n√®re 5 id√©es de contenu pour une campagne sur les r√©seaux sociaux..." title="Posez votre question √† l'assistant IA ici"></textarea>
                    <button class="btn" onclick="envoyer()">Envoyer</button>
                    <pre id="reponse">Votre r√©ponse IA appara√Ætra ici.</pre>
                </div>
            </div>
        </section>

        <section class="section features-section">
            <div class="tile feature-tile">
                <h3>üí° Cas d'Usage Inspirants</h3>
                <p>D√©couvrez des exemples concrets et r√©ussis d'application de l'IA dans le marketing.</p>
                <button class="btn secondary-cta">Voir les cas</button>
            </div>
            <div class="tile feature-tile">
                <h3>üõ†Ô∏è Nos Outils IA Recommand√©s</h3>
                <p>Une s√©lection des meilleurs outils d'intelligence artificielle pour optimiser votre travail quotidien.</p>
                <button class="btn secondary-cta">D√©couvrir les outils</button>
            </div>
            <div class="tile feature-tile">
                <h3>üìö Guides & Prompts IA</h3>
                <p>Acc√©dez √† des guides pratiques et des prompts optimis√©s pour tirer le meilleur de l'IA.</p>
                <button class="btn secondary-cta">Consulter les guides</button>
            </div>
        </section>
    </main>

    <footer class="footer">
        Auteur : **Steeve Pires Madeira / Marketing - Equipe Cr√©a**
    </footer>

    <script>
        // URL pour la Netlify Function qui r√©cup√®re les donn√©es de Google Sheets
        const PROXY_URL = "/.netlify/functions/proxy";

        // Cette fonction sera appel√©e par le header pour mettre √† jour la bulle
        async function mettreAJourBulleDemandes() {
            const notif = document.getElementById("notif-count");
            if (!notif) {
                console.warn("√âl√©ment #notif-count non trouv√©. La bulle de notification ne peut pas √™tre mise √† jour.");
                return;
            }
            try {
                const res = await fetch(`${PROXY_URL}?action=getDemandesIA`);
                if (!res.ok) {
                    throw new Error(`HTTP error! status: ${res.status}`);
                }
                const demandes = await res.json();
                const demandesNonTraitees = demandes.filter(d => !d.traite);
                notif.textContent = demandesNonTraitees.length;
                notif.style.display = demandesNonTraitees.length > 0 ? "inline-block" : "none";
            } catch (e) {
                console.error("Erreur lors de la mise √† jour du compteur de demandes :", e);
                notif.style.display = "none";
            }
        }

        document.addEventListener("DOMContentLoaded", () => {
            fetch("header.html")
                .then(res => {
                    if (!res.ok) {
                        throw new Error(`HTTP error! status: ${res.status}`);
                    }
                    return res.text();
                })
                .then(data => {
                    document.getElementById("header-placeholder").innerHTML = data;

                    // Assurez-vous que le lien des demandes est positionn√© relativement pour la bulle
                    const demandeLink = document.querySelector("a.demandes");
                    if (demandeLink && (getComputedStyle(demandeLink).position === "static" || !getComputedStyle(demandeLink).position)) {
                        demandeLink.style.position = "relative";
                    }

                    // Une fois le header charg√© et inject√©, on peut mettre √† jour la bulle
                    mettreAJourBulleDemandes();

                    // Logique pour marquer le lien "Accueil" comme actif dans le menu
                    const path = location.pathname.split("/").pop();
                    const links = document.querySelectorAll("nav a");
                    links.forEach(link => {
                        if (path === "" || path === "index.html") {
                            if (link.getAttribute("href") === "index.html") {
                                link.classList.add("active");
                            }
                        } else if (link.getAttribute("href") === path) {
                            link.classList.add("active");
                        }
                    });

                    // Cacher le loader une fois le contenu principal (y compris le header) charg√©
                    document.getElementById("loader").classList.add("hidden");
                })
                .catch(error => {
                    console.error("Erreur lors du chargement de header.html:", error);
                    document.getElementById("header-placeholder").innerHTML =
                        "<p style='color:red;text-align:center'>Erreur de chargement du menu</p>";
                    // Cacher le loader m√™me en cas d'erreur
                    document.getElementById("loader").classList.add("hidden");
                });
        });

        async function envoyer() {
            const userInputElement = document.getElementById("user-input");
            const reponseElement = document.getElementById("reponse");
            const userMessage = userInputElement.value.trim(); // Supprime les espaces superflus

            if (!userMessage) {
                reponseElement.textContent = "Veuillez poser une question !";
                return;
            }

            // Afficher un message de chargement
            reponseElement.textContent = "Chargement de la r√©ponse...";
            userInputElement.value = ''; // Efface le champ de saisie apr√®s l'envoi

            try {
                const response = await fetch("/.netlify/functions/chat-clean", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ message: userMessage })
                });

                const text = await response.text();
                let data;

                try {
                    data = JSON.parse(text);
                } catch (e) {
                    reponseElement.textContent = "‚ùå Erreur : La r√©ponse de l'API est invalide. Veuillez r√©essayer.\n" + text;
                    console.error("Erreur de parsing JSON de la r√©ponse de chat-clean:", e, text);
                    return;
                }

                if (data.error) {
                    reponseElement.textContent = `‚ùå Erreur de l'API : ${data.error}. Veuillez contacter l'administrateur.`;
                    console.error("Erreur renvoy√©e par l'API chat-clean:", data.error);
                } else {
                    reponseElement.textContent = data.reply || "‚úÖ Aucune r√©ponse g√©n√©r√©e. L'IA n'a peut-√™tre rien trouv√©.";
                }
            } catch (networkError) {
                reponseElement.textContent = `‚ùå Erreur r√©seau ou fonction inaccessible: ${networkError.message}. V√©rifiez votre connexion.`;
                console.error("Erreur r√©seau ou fonction Netlify inaccessible:", networkError);
            }
        }
    </script>
</body>
</html>
