<!DOCTYPE html>

<html lang="fr">

<head>

Â  Â  <meta charset="UTF-8" />

Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

Â  Â  <title>Ã‰quipe</title>

Â  Â  <link rel="stylesheet" href="style.css" />

Â  Â  <style>

Â  Â  Â  Â  body {

Â  Â  Â  Â  Â  Â  opacity: 0;

Â  Â  Â  Â  Â  Â  transition: opacity 0.3s ease-in;

Â  Â  Â  Â  Â  Â  margin: 0;

Â  Â  Â  Â  Â  Â  font-family: Arial, sans-serif;

Â  Â  Â  Â  Â  Â  background: #f0f4f8;

Â  Â  Â  Â  }

Â  Â  Â  Â  main {

Â  Â  Â  Â  Â  Â  display: none; /* Main cachÃ© au dÃ©but, sera affichÃ© par le script */

Â  Â  Â  Â  }

Â  Â  Â  Â  .container {

Â  Â  Â  Â  Â  Â  max-width: 900px;

Â  Â  Â  Â  Â  Â  margin: 40px auto;

Â  Â  Â  Â  Â  Â  padding: 20px;

Â  Â  Â  Â  Â  Â  background: #fff;

Â  Â  Â  Â  Â  Â  border-radius: 20px;

Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 20px rgba(0,0,0,0.1);

Â  Â  Â  Â  }

Â  Â  Â  Â  .btn-creer {

Â  Â  Â  Â  Â  Â  display: block;

Â  Â  Â  Â  Â  Â  margin: 0 auto 30px;

Â  Â  Â  Â  Â  Â  background: #0077b6;

Â  Â  Â  Â  Â  Â  color: white;

Â  Â  Â  Â  Â  Â  padding: 12px 24px;

Â  Â  Â  Â  Â  Â  border-radius: 8px;

Â  Â  Â  Â  Â  Â  text-decoration: none;

Â  Â  Â  Â  Â  Â  font-weight: bold;

Â  Â  Â  Â  Â  Â  width: fit-content;

Â  Â  Â  Â  Â  Â  text-align: center;

Â  Â  Â  Â  Â  Â  transition: background 0.2s ease;

Â  Â  Â  Â  }

Â  Â  Â  Â  .btn-creer:hover {

Â  Â  Â  Â  Â  Â  background: #005f8a;

Â  Â  Â  Â  }

Â  Â  Â  Â  .filters {

Â  Â  Â  Â  Â  Â  text-align: center;

Â  Â  Â  Â  Â  Â  margin-bottom: 20px;

Â  Â  Â  Â  }

Â  Â  Â  Â  .filters select,

Â  Â  Â  Â  .filters input {

Â  Â  Â  Â  Â  Â  padding: 8px 12px;

Â  Â  Â  Â  Â  Â  border-radius: 6px;

Â  Â  Â  Â  Â  Â  border: 1px solid #ccc;

Â  Â  Â  Â  Â  Â  font-size: 1rem;

Â  Â  Â  Â  Â  Â  margin: 0 10px;

Â  Â  Â  Â  Â  Â  transition: border-color 0.2s ease;

Â  Â  Â  Â  }

Â  Â  Â  Â  .filters select:focus,

Â  Â  Â  Â  .filters input:focus {

Â  Â  Â  Â  Â  Â  outline: none;

Â  Â  Â  Â  Â  Â  border-color: #0077b6;

Â  Â  Â  Â  }

Â  Â  Â  Â  .grid {

Â  Â  Â  Â  Â  Â  display: flex;

Â  Â  Â  Â  Â  Â  flex-wrap: wrap;

Â  Â  Â  Â  Â  Â  gap: 16px;

Â  Â  Â  Â  Â  Â  justify-content: center ;

Â  Â  Â  Â  }

Â  Â  Â  Â  .vignette {

Â  Â  Â  Â  Â  Â  background: white;

Â  Â  Â  Â  Â  Â  border-radius: 12px;

Â  Â  Â  Â  Â  Â  box-shadow: 0 6px 15px rgba(0,0,0,0.1);

Â  Â  Â  Â  Â  Â  padding: 12px;

Â  Â  Â  Â  Â  Â  width: 220px;

Â  Â  Â  Â  Â  Â  position: relative;

Â  Â  Â  Â  Â  Â  transition: transform 0.3s ease, box-shadow 0.3s ease;

Â  Â  Â  Â  Â  Â  display: flex;

Â  Â  Â  Â  Â  Â  flex-direction: column;

Â  Â  Â  Â  Â  Â  align-items: center;

Â  Â  Â  Â  Â  Â  justify-content: space-between;

Â  Â  Â  Â  Â  Â  cursor: pointer;

Â  Â  Â  Â  }

Â  Â  Â  Â  .vignette:hover {

Â  Â  Â  Â  Â  Â  transform: translateY(-6px);

Â  Â  Â  Â  Â  Â  box-shadow: 0 10px 20px rgba(0,0,0,0.15);

Â  Â  Â  Â  }

Â  Â  Â  Â  .vignette img {

Â  Â  Â  Â  Â  Â  width: 80px;

Â  Â  Â  Â  Â  Â  height: 80px;

Â  Â  Â  Â  Â  Â  border-radius: 50%;

Â  Â  Â  Â  Â  Â  object-fit: cover;

Â  Â  Â  Â  Â  Â  margin: 0 auto 8px;

Â  Â  Â  Â  Â  Â  display: block;

Â  Â  Â  Â  }

Â  Â  Â  Â  .vignette h3 {

Â  Â  Â  Â  Â  Â  margin: 8px 0 4px;

Â  Â  Â  Â  Â  Â  font-size: 1.1rem;

Â  Â  Â  Â  Â  Â  color: #0077b6;

Â  Â  Â  Â  Â  Â  text-align: center;

Â  Â  Â  Â  }

Â  Â  Â  Â  .vignette .pole {

Â  Â  Â  Â  Â  Â  font-size: 0.85rem;

Â  Â  Â  Â  Â  Â  color: #555;

Â  Â  Â  Â  Â  Â  text-align: center;

Â  Â  Â  Â  Â  Â  margin-bottom: 6px;

Â  Â  Â  Â  }

Â  Â  Â  Â  .icon-bar {

Â  Â  Â  Â  Â  Â  display: flex;

Â  Â  Â  Â  Â  Â  justify-content: center;

Â  Â  Â  Â  Â  Â  gap: 8px;

Â  Â  Â  Â  Â  Â  margin-top: auto;

Â  Â  Â  Â  Â  Â  padding-top: 10px;

Â  Â  Â  Â  }

Â  Â  Â  Â  .btn-edit,

Â  Â  Â  Â  .btn-delete,

Â  Â  Â  Â  .btn-note {

Â  Â  Â  Â  Â  Â  background: #f0f0f0;

Â  Â  Â  Â  Â  Â  border: 1px solid #ccc;

Â  Â  Â  Â  Â  Â  border-radius: 6px;

Â  Â  Â  Â  Â  Â  padding: 4px 8px;

Â  Â  Â  Â  Â  Â  font-size: 0.9rem;

Â  Â  Â  Â  Â  Â  color: #0077b6;

Â  Â  Â  Â  Â  Â  cursor: pointer;

Â  Â  Â  Â  Â  Â  transition: background 0.2s ease, border-color 0.2s ease, color 0.2s ease;

Â  Â  Â  Â  }

Â  Â  Â  Â  .btn-edit:hover,

Â  Â  Â  Â  .btn-delete:hover,

Â  Â  Â  Â  .btn-note:hover {

Â  Â  Â  Â  Â  Â  background: #e0f3fc;

Â  Â  Â  Â  Â  Â  border-color: #0077b6;

Â  Â  Â  Â  Â  Â  color: #005f8a;

Â  Â  Â  Â  }

Â  Â  Â  Â  .btn-note {

Â  Â  Â  Â  Â  Â  padding: 4px 8px;

Â  Â  Â  Â  }

Â  Â  Â  Â  .note-badge {

Â  Â  Â  Â  Â  Â  position: absolute;

Â  Â  Â  Â  Â  Â  top: 8px;

Â  Â  Â  Â  Â  Â  right: 8px;

Â  Â  Â  Â  Â  Â  background: #ffcb05;

Â  Â  Â  Â  Â  Â  color: #000;

Â  Â  Â  Â  Â  Â  font-size: 0.7rem;

Â  Â  Â  Â  Â  Â  padding: 2px 6px;

Â  Â  Â  Â  Â  Â  border-radius: 10px;

Â  Â  Â  Â  Â  Â  font-weight: bold;

Â  Â  Â  Â  Â  Â  display: none;

Â  Â  Â  Â  Â  Â  z-index: 10;

Â  Â  Â  Â  }

Â  Â  Â  Â  .note-editor {

Â  Â  Â  Â  Â  Â  max-height: 0;

Â  Â  Â  Â  Â  Â  overflow: hidden;

Â  Â  Â  Â  Â  Â  opacity: 0;

Â  Â  Â  Â  Â  Â  transition: max-height 0.3s ease, opacity 0.3s ease;

Â  Â  Â  Â  Â  Â  margin-top: 10px;

Â  Â  Â  Â  Â  Â  width: 100%;

Â  Â  Â  Â  }

Â  Â  Â  Â  .note-editor.open {

Â  Â  Â  Â  Â  Â  max-height: 300px;

Â  Â  Â  Â  Â  Â  opacity: 1;

Â  Â  Â  Â  }

Â  Â  Â  Â  .note-editor textarea {

Â  Â  Â  Â  Â  Â  width: calc(100% - 12px);

Â  Â  Â  Â  Â  Â  min-height: 60px;

Â  Â  Â  Â  Â  Â  border-radius: 6px;

Â  Â  Â  Â  Â  Â  border: 1px solid #ccc;

Â  Â  Â  Â  Â  Â  padding: 6px;

Â  Â  Â  Â  Â  Â  font-size: 0.85rem;

Â  Â  Â  Â  Â  Â  resize: vertical;

Â  Â  Â  Â  Â  Â  box-sizing: border-box;

Â  Â  Â  Â  }

Â  Â  Â  Â  .note-editor .actions {

Â  Â  Â  Â  Â  Â  display: flex;

Â  Â  Â  Â  Â  Â  justify-content: space-between;

Â  Â  Â  Â  Â  Â  gap: 4px;

Â  Â  Â  Â  Â  Â  margin-top: 6px;

Â  Â  Â  Â  }

Â  Â  Â  Â  .note-editor .actions button {

Â  Â  Â  Â  Â  Â  flex: 1;

Â  Â  Â  Â  Â  Â  font-size: 0.8rem;

Â  Â  Â  Â  Â  Â  border-radius: 4px;

Â  Â  Â  Â  Â  Â  border: none;

Â  Â  Â  Â  Â  Â  cursor: pointer;

Â  Â  Â  Â  Â  Â  padding: 6px 8px;

Â  Â  Â  Â  Â  Â  color: white;

Â  Â  Â  Â  Â  Â  transition: background 0.2s ease;

Â  Â  Â  Â  }

Â  Â  Â  Â  .note-editor .save-note { background: #0077b6; }

Â  Â  Â  Â  .note-editor .save-note:hover { background: #005f8a; }

Â  Â  Â  Â  .note-editor .clear-note { background: #999; }

Â  Â  Â  Â  .note-editor .clear-note:hover { background: #777; }

Â  Â  Â  Â  .note-editor .close-note { background: #bbb; }

Â  Â  Â  Â  .note-editor .close-note:hover { background: #999; }



Â  Â  Â  Â  .side-panel {

Â  Â  Â  Â  Â  Â  position: fixed;

Â  Â  Â  Â  Â  Â  top: 0;

Â  Â  Â  Â  Â  Â  right: 0;

Â  Â  Â  Â  Â  Â  width: 340px;

Â  Â  Â  Â  Â  Â  height: 100%;

Â  Â  Â  Â  Â  Â  background: #f9f9f9;

Â  Â  Â  Â  Â  Â  box-shadow: -4px 0 12px rgba(0, 0, 0, 0.2);

Â  Â  Â  Â  Â  Â  padding: 24px 20px;

Â  Â  Â  Â  Â  Â  overflow-y: auto;

Â  Â  Â  Â  Â  Â  transition: transform 0.3s ease;

Â  Â  Â  Â  Â  Â  z-index: 1000;

Â  Â  Â  Â  Â  Â  transform: translateX(100%);

Â  Â  Â  Â  Â  Â  display: flex;

Â  Â  Â  Â  Â  Â  flex-direction: column;

Â  Â  Â  Â  Â  Â  gap: 16px;

Â  Â  Â  Â  }

Â  Â  Â  Â  .side-panel.show {

Â  Â  Â  Â  Â  Â  transform: translateX(0);

Â  Â  Â  Â  }

Â  Â  Â  Â  .side-panel .close-panel {

Â  Â  Â  Â  Â  Â  position: absolute;

Â  Â  Â  Â  Â  Â  top: 12px;

Â  Â  Â  Â  Â  Â  left: 12px;

Â  Â  Â  Â  Â  Â  background: transparent;

Â  Â  Â  Â  Â  Â  font-size: 24px;

Â  Â  Â  Â  Â  Â  border: none;

Â  Â  Â  Â  Â  Â  cursor: pointer;

Â  Â  Â  Â  Â  Â  color: #333;

Â  Â  Â  Â  Â  Â  z-index: 1001;

Â  Â  Â  Â  }

Â  Â  Â  Â  .side-panel h2 {

Â  Â  Â  Â  Â  Â  margin-top: 0;

Â  Â  Â  Â  Â  Â  color: #0077b6;

Â  Â  Â  Â  Â  Â  font-size: 1.6rem;

Â  Â  Â  Â  Â  Â  border-bottom: 2px solid #e0e0e0;

Â  Â  Â  Â  Â  Â  padding-bottom: 10px;

Â  Â  Â  Â  Â  Â  margin-bottom: 20px;

Â  Â  Â  Â  }

Â  Â  Â  Â  .side-panel ul {

Â  Â  Â  Â  Â  Â  list-style: disc;

Â  Â  Â  Â  Â  Â  padding-left: 20px;

Â  Â  Â  Â  Â  Â  margin: 0;

Â  Â  Â  Â  }

Â  Â  Â  Â  .side-panel p {

Â  Â  Â  Â  Â  Â  margin: 0 0 10px;

Â  Â  Â  Â  }

Â  Â  Â  Â  .side-panel .note-content {

Â  Â  Â  Â  Â  Â  background: #fffbe6;

Â  Â  Â  Â  Â  Â  padding: 10px 12px;

Â  Â  Â  Â  Â  Â  border-left: 4px solid #ffcb05;

Â  Â  Â  Â  Â  Â  border-radius: 6px;

Â  Â  Â  Â  Â  Â  font-size: 0.95rem;

Â  Â  Â  Â  Â  Â  margin-top: 15px;

Â  Â  Â  Â  }

Â  Â  Â  Â  /* Styles spÃ©cifiques pour la galerie dans le panneau latÃ©ral */

Â  Â  Â  Â  .side-panel .gallery-section {

Â  Â  Â  Â  Â  Â  margin-top: 20px;

Â  Â  Â  Â  Â  Â  border-top: 1px solid #eee;

Â  Â  Â  Â  Â  Â  padding-top: 15px;

Â  Â  Â  Â  }

Â  Â  Â  Â  .side-panel .gallery-section h3 {

Â  Â  Â  Â  Â  Â  color: #0077b6;

Â  Â  Â  Â  Â  Â  font-size: 1.2rem;

Â  Â  Â  Â  Â  Â  margin-bottom: 10px;

Â  Â  Â  Â  }

Â  Â  Â  Â  .side-panel .gallery-images-container {

Â  Â  Â  Â  Â  Â  display: flex;

Â  Â  Â  Â  Â  Â  flex-wrap: wrap;

Â  Â  Â  Â  Â  Â  gap: 10px;

Â  Â  Â  Â  Â  Â  justify-content: center;

Â  Â  Â  Â  Â  Â  margin-bottom: 10px;

Â  Â  Â  Â  Â  Â  min-height: 100px;

Â  Â  Â  Â  Â  Â  background-color: #e9f5ff;

Â  Â  Â  Â  Â  Â  padding: 5px;

Â  Â  Â  Â  Â  Â  border-radius: 8px;

Â  Â  Â  Â  }

Â  Â  Â  Â  .side-panel .gallery-images-container img {

Â  Â  Â  Â  Â  Â  width: 100%;

Â  Â  Â  Â  Â  Â  max-width: 150px;

Â  Â  Â  Â  Â  Â  height: 100px;

Â  Â  Â  Â  Â  Â  object-fit: cover;

Â  Â  Â  Â  Â  Â  border-radius: 8px;

Â  Â  Â  Â  Â  Â  box-shadow: 0 2px 8px rgba(0,0,0,0.1);

Â  Â  Â  Â  Â  Â  border: 1px solid #ddd;

Â  Â  Â  Â  Â  Â  cursor: pointer; /* Add cursor pointer to indicate clickability */

Â  Â  Â  Â  }

Â  Â  Â  Â  .side-panel .no-image-placeholder {

Â  Â  Â  Â  Â  Â  text-align: center;

Â  Â  Â  Â  Â  Â  color: #888;

Â  Â  Â  Â  Â  Â  font-style: italic;

Â  Â  Â  Â  Â  Â  font-size: 0.9rem;

Â  Â  Â  Â  Â  Â  padding: 10px 0;

Â  Â  Â  Â  }

Â  Â  Â  Â  footer {

Â  Â  Â  Â  Â  Â  text-align: center;

Â  Â  Â  Â  Â  Â  margin-top: 4rem;

Â  Â  Â  Â  Â  Â  font-size: 0.9rem;

Â  Â  Â  Â  Â  Â  color: #888;

Â  Â  Â  Â  Â  Â  padding-bottom: 20px;

Â  Â  Â  Â  }

Â  Â  </style>

</head>

<body>

Â  Â  <div id="header-placeholder"></div>

Â  Â  <main>

Â  Â  Â  Â  <div class="container">

Â  Â  Â  Â  Â  Â  <a href="profil.html" class="btn-creer">+ CrÃ©er un nouveau profil</a>

Â  Â  Â  Â  Â  Â  <div class="filters">

Â  Â  Â  Â  Â  Â  Â  Â  <select id="filterPole">

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="">Tous les pÃ´les</option>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="PÃ´le crÃ©a.">PÃ´le crÃ©a.</option>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="CRM">CRM</option>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Communication">Communication</option>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Partenariats">Partenariats</option>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Marketing digital">Marketing digital</option>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Positionnement">Positionnement</option>

Â  Â  Â  Â  Â  Â  Â  Â  </select>

Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="searchInput" placeholder="Rechercher un nom ou outil...">

Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="grid" id="profil-list"></div>

Â  Â  Â  Â  </div>

Â  Â  </main>

Â  Â  <div id="side-panel" class="side-panel">

Â  Â  Â  Â  <button class="close-panel">Ã—</button>

Â  Â  Â  Â  <div id="panel-content"></div>

Â  Â  </div>



Â  Â  <footer>Mis Ã  jour automatiquement le 2025-06-09</footer>



Â  Â  <script>

Â  Â  Â  Â  const PROXY_URL = "/.netlify/functions/proxy";

Â  Â  Â  Â  let profils = [];

Â  Â  Â  Â  let galleryPrompts = []; // Nouvelle variable globale pour stocker les prompts de la galerie



Â  Â  Â  Â  const listContainer = document.getElementById("profil-list");

Â  Â  Â  Â  const filterPole = document.getElementById("filterPole");

Â  Â  Â  Â  const searchInput = document.getElementById("searchInput");

Â  Â  Â  Â  const sidePanel = document.getElementById("side-panel");

Â  Â  Â  Â  const panelContent = document.getElementById("panel-content");

Â  Â  Â  Â  const closePanelBtn = document.querySelector(".close-panel");





Â  Â  Â  Â  function normalizeString(str) {

Â  Â  Â  Â  Â  Â  if (typeof str !== 'string') return '';

Â  Â  Â  Â  Â  Â  return str.normalize("NFD").replace(/\p{Diacritic}/gu, "").toLowerCase();

Â  Â  Â  Â  }



Â  Â  Â  Â  function renderProfils() {

Â  Â  Â  Â  Â  Â  console.log("Ã‰quipe: DÃ©but du rendu des profils...");

Â  Â  Â  Â  Â  Â  const selectedPole = normalizeString(filterPole.value);

Â  Â  Â  Â  Â  Â  const searchQuery = normalizeString(searchInput.value);

Â  Â  Â  Â  Â  Â  listContainer.innerHTML = "";



Â  Â  Â  Â  Â  Â  const filteredProfils = profils.filter(p => {

Â  Â  Â  Â  Â  Â  Â  Â  const poleNormalized = normalizeString(p.pole || '');

Â  Â  Â  Â  Â  Â  Â  Â  const nameNormalized = normalizeString(p.name || '');

Â  Â  Â  Â  Â  Â  Â  Â  const toolsNormalized = (Array.isArray(p.tools) ? p.tools : []).map(t => normalizeString(t));



Â  Â  Â  Â  Â  Â  Â  Â  const matchPole = !selectedPole || poleNormalized === selectedPole;

Â  Â  Â  Â  Â  Â  Â  Â  const matchSearch = !searchQuery || nameNormalized.includes(searchQuery) || toolsNormalized.some(tool => tool.includes(searchQuery));

Â  Â  Â  Â  Â  Â  Â  Â  return matchPole && matchSearch;

Â  Â  Â  Â  Â  Â  });



Â  Â  Â  Â  Â  Â  if (filteredProfils.length === 0) {

Â  Â  Â  Â  Â  Â  Â  Â  listContainer.innerHTML = '<p style="text-align: center; color: #666; width: 100%;">Aucun profil ne correspond Ã  vos critÃ¨res.</p>';

Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  filteredProfils.forEach((p) => {

Â  Â  Â  Â  Â  Â  Â  Â  const div = document.createElement("div");

Â  Â  Â  Â  Â  Â  Â  Â  div.className = "vignette";

Â  Â  Â  Â  Â  Â  Â  Â  div.dataset.id = p.id;



Â  Â  Â  Â  Â  Â  Â  Â  const hasNote = (p.note || '').trim() !== '';



Â  Â  Â  Â  Â  Â  Â  Â  div.innerHTML = `

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="note-badge" style="${hasNote ? 'display: inline-block;' : 'display: none;'}">Note</span>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <img src="${p.photo || 'https://via.placeholder.com/80x80?text=Profil'}" alt="${p.name || 'Profil'}" />

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h3>${p.name || 'Nom Inconnu'}</h3>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="pole">${p.pole || 'PÃ´le Inconnu'}</div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="icon-bar">

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn-note" title="Note">ğŸ—’ï¸</button>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn-edit" title="Ã‰diter">âœï¸</button>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn-delete" title="Supprimer">ğŸ—‘ï¸</button>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="note-editor">

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <textarea>${p.note || ''}</textarea>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="actions">

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="save-note">Enregistrer</button>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="clear-note">Effacer</button>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="close-note">Retour</button>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  `;

Â  Â  Â  Â  Â  Â  Â  Â  const noteBadge = div.querySelector(".note-badge");

Â  Â  Â  Â  Â  Â  Â  Â  const noteEditor = div.querySelector(".note-editor");

Â  Â  Â  Â  Â  Â  Â  Â  const textarea = noteEditor.querySelector("textarea");



Â  Â  Â  Â  Â  Â  Â  Â  div.querySelector(".btn-note").addEventListener("click", e => {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  e.stopPropagation();

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.log("Ã‰quipe: Clic sur 'Note' pour", p.name);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  document.querySelectorAll(".note-editor.open").forEach(el => {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (el !== noteEditor) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  el.classList.remove("open");

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  noteEditor.classList.toggle("open");

Â  Â  Â  Â  Â  Â  Â  Â  });



Â  Â  Â  Â  Â  Â  Â  Â  div.querySelector(".save-note").addEventListener("click", async e => {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  e.stopPropagation();

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.log("Ã‰quipe: Clic sur 'Enregistrer note' pour", p.name);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const content = textarea.value.trim();

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  try {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const res = await fetch(`${PROXY_URL}?action=updateProfil`, {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  method: "POST",

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  headers: { "Content-Type": "application/json" },

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  body: JSON.stringify({ id: p.id, note: content })

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const data = await res.json();

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (data.success) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.log("Ã‰quipe: Note enregistrÃ©e avec succÃ¨s pour", p.name);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  p.note = content;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  noteBadge.style.display = content ? 'inline-block' : 'none';

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  noteEditor.classList.remove("open");

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.error("Ã‰quipe: Erreur lors de l'enregistrement de la note:", data.message);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  alert("Erreur lors de l'enregistrement de la note : " + data.message);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } catch (error) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.error("Ã‰quipe: Erreur rÃ©seau/serveur lors de l'enregistrement de la note:", error);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  alert("Erreur rÃ©seau/serveur lors de l'enregistrement de la note.");

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  });



Â  Â  Â  Â  Â  Â  Â  Â  div.querySelector(".clear-note").addEventListener("click", async e => {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  e.stopPropagation();

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.log("Ã‰quipe: Clic sur 'Effacer note' pour", p.name);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  textarea.value = "";

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  try {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const res = await fetch(`${PROXY_URL}?action=updateProfil`, {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  method: "POST",

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  headers: { "Content-Type": "application/json" },

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  body: JSON.stringify({ id: p.id, note: "" })

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const data = await res.json();

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (data.success) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.log("Ã‰quipe: Note effacÃ©e avec succÃ¨s pour", p.name);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  p.note = "";

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  noteBadge.style.display = 'none';

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  noteEditor.classList.remove("open");

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.error("Ã‰quipe: Erreur lors de l'effacement de la note:", data.message);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  alert("Erreur lors de l'effacement de la note : " + data.message);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } catch (error) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.error("Ã‰quipe: Erreur rÃ©seau/serveur lors de l'effacement de la note:", error);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  alert("Erreur rÃ©seau/serveur lors de l'effacement de la note.");

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  });



Â  Â  Â  Â  Â  Â  Â  Â  div.querySelector(".close-note").addEventListener("click", e => {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  e.stopPropagation();

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.log("Ã‰quipe: Clic sur 'Retour note' pour", p.name);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  textarea.value = p.note || '';

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  noteEditor.classList.remove("open");

Â  Â  Â  Â  Â  Â  Â  Â  });



Â  Â  Â  Â  Â  Â  Â  Â  div.querySelector(".btn-edit").addEventListener("click", e => {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  e.stopPropagation();

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.log("Ã‰quipe: Clic sur 'Ã‰diter' pour", p.name);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  window.location.href = `profil.html?edit=${encodeURIComponent(p.id)}`;

Â  Â  Â  Â  Â  Â  Â  Â  });



Â  Â  Â  Â  Â  Â  Â  Â  div.querySelector(".btn-delete").addEventListener("click", async e => {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  e.stopPropagation();

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.log("Ã‰quipe: Clic sur 'Supprimer' pour", p.name);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (confirm(`Supprimer dÃ©finitivement ${p.name} ?`)) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  try {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const res = await fetch(`${PROXY_URL}?action=deleteProfil`, {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  method: "POST",

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  headers: { "Content-Type": "application/json" },

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  body: JSON.stringify({ id: p.id })

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const data = await res.json();

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (data.success) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.log("Ã‰quipe: Profil supprimÃ© avec succÃ¨s:", p.name);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  profils = profils.filter(profile => profile.id !== p.id);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Re-charger les prompts pour s'assurer que les images sont Ã  jour si le profil est supprimÃ©

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  initPageData(); // Appel de la fonction globale d'initialisation

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.error("Ã‰quipe: Erreur lors de la suppression du profil:", data.message);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  alert("Erreur lors de la suppression du profil : " + data.message);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } catch (error) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.error("Ã‰quipe: Erreur rÃ©seau/serveur lors de la suppression du profil:", error);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  alert("Erreur rÃ©seau/serveur lors de la suppression du profil.");

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  });



Â  Â  Â  Â  Â  Â  Â  Â  // Ã‰couteur pour ouvrir le panneau latÃ©ral (dÃ©tails du profil)

Â  Â  Â  Â  Â  Â  Â  Â  div.addEventListener("click", e => {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (!e.target.closest(".icon-bar") && !e.target.closest(".note-editor")) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.log("Ã‰quipe: Ouverture du panneau latÃ©ral pour", p.name);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let gallerySection = '';

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const profilNameNormalized = normalizeString(p.name || '');



Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Filtrer les prompts de la galerie par l'auteur (nom du profil)

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Nous nous basons sur galleryPrompts qui est dÃ©jÃ  chargÃ©.

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const imagesByAuthor = galleryPrompts.filter(prompt => {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Assurez-vous que prompt.auteur existe et est comparable

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return normalizeString(prompt.auteur || '') === profilNameNormalized;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }).map(prompt => prompt.imageUrl).filter(Boolean); // Extrait seulement les URLs non vides



Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.log(`DEBUG: Images de galerie trouvÃ©es pour "${p.name}" :`, imagesByAuthor);



Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (imagesByAuthor.length > 0) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Nous allons montrer les 2 derniÃ¨res images publiÃ©es par cet auteur.

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const lastTwoImages = imagesByAuthor.slice(-2);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.log("DEBUG: Les 2 derniÃ¨res images sÃ©lectionnÃ©es pour l'affichage:", lastTwoImages);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const imagesHtml = lastTwoImages.map(imgSrc => {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (imgSrc && typeof imgSrc === 'string' && (imgSrc.startsWith('http') || imgSrc.startsWith('/') || imgSrc.startsWith('./') || imgSrc.startsWith('../'))) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Make images clickable

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return `<a href="galerie.html?imageUrl=${encodeURIComponent(imgSrc)}" target="_blank"><img src="${imgSrc}" alt="Image de galerie du prompt" onerror="this.onerror=null;this.src='https://via.placeholder.com/150x100?text=Erreur+image';" title="Image: ${imgSrc}"></a>`;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.warn("DEBUG: URL d'image de galerie invalide dÃ©tectÃ©e:", imgSrc);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return `<img src="https://via.placeholder.com/150x100?text=Image+Invalide" alt="Image invalide" title="URL invalide: ${imgSrc}">`;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }).join('');



Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  gallerySection = `

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="gallery-section">

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h3>Derniers prompts partagÃ©s</h3>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="gallery-images-container">

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${imagesHtml}

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  `;Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.log("DEBUG: Aucune image de galerie trouvÃ©e pour l'auteur :", p.name);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  gallerySection = `

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="gallery-section">

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h3>Derniers prompts partagÃ©s</h3>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="no-image-placeholder">Aucun prompt partagÃ© par ${p.name} n'a Ã©tÃ© trouvÃ©.</p>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="no-image-placeholder">

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <a href="prompt.html">Partager un prompt maintenant !</a>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </p>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  `;Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const toolsList = (Array.isArray(p.tools) ? p.tools : []).map(t => `<li>${t}</li>`).join('');



Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  panelContent.innerHTML = `

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h2>${p.name || 'Nom Inconnu'}</h2>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p><strong>PÃ´le :</strong> ${p.pole || 'â€”'}</p>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p><strong>Outils IA :</strong></p>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <ul>${toolsList}</ul>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${hasNote ? `<div class="note-content"><strong>Note :</strong><br>${p.note}</div>` : ''}

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${gallerySection}

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  `;Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  sidePanel.classList.add("show");

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  });



Â  Â  Â  Â  Â  Â  Â  Â  listContainer.appendChild(div);

Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  console.log("Ã‰quipe: Rendu des profils terminÃ©.");

Â  Â  Â  Â  }



Â  Â  Â  Â  closePanelBtn.addEventListener("click", () => {

Â  Â  Â  Â  Â  Â  console.log("Ã‰quipe: Clic sur le bouton de fermeture du panneau.");

Â  Â  Â  Â  Â  Â  sidePanel.classList.remove("show");

Â  Â  Â  Â  });



Â  Â  Â  Â  document.addEventListener("click", event => {

Â  Â  Â  Â  Â  Â  if (sidePanel.classList.contains("show") && !sidePanel.contains(event.target) && !event.target.closest(".vignette")) {

Â  Â  Â  Â  Â  Â  Â  Â  console.log("Ã‰quipe: Clic en dehors du panneau, fermeture.");

Â  Â  Â  Â  Â  Â  Â  Â  sidePanel.classList.remove("show");

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  });



Â  Â  Â  Â  filterPole.addEventListener("change", renderProfils);

Â  Â  Â  Â  searchInput.addEventListener("input", renderProfils);



Â  Â  Â  Â  async function mettreAJourBulleDemandes() {

Â  Â  Â  Â  Â  Â  const notif = document.getElementById("notif-count");

Â  Â  Â  Â  Â  Â  if (!notif) {

Â  Â  Â  Â  Â  Â  Â  Â  console.warn("Ã‰quipe: L'Ã©lÃ©ment 'notif-count' n'a pas Ã©tÃ© trouvÃ© dans le header.");

Â  Â  Â  Â  Â  Â  Â  Â  return;

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  try {

Â  Â  Â  Â  Â  Â  Â  Â  console.log("Ã‰quipe: Tentative de rÃ©cupÃ©ration des demandes pour la bulle...");

Â  Â  Â  Â  Â  Â  Â  Â  const res = await fetch(`${PROXY_URL}?action=getDemandesIA`);

Â  Â  Â  Â  Â  Â  Â  Â  if (!res.ok) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.error(`Ã‰quipe: Erreur HTTP lors de la rÃ©cupÃ©ration des demandes: ${res.status}`);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  throw new Error(`Erreur HTTP: ${res.status}`);

Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  const demandes = await res.json();

Â  Â  Â  Â  Â  Â  Â  Â  console.log("Ã‰quipe: Demandes rÃ©cupÃ©rÃ©es pour la bulle:", demandes);

Â  Â  Â  Â  Â  Â  Â  Â  notif.textContent = Array.isArray(demandes) ? demandes.length : 0;

Â  Â  Â  Â  Â  Â  Â  Â  notif.style.display = (Array.isArray(demandes) && demandes.length > 0) ? "inline-block" : "none";

Â  Â  Â  Â  Â  Â  } catch (e) {

Â  Â  Â  Â  Â  Â  Â  Â  console.error("Ã‰quipe: Erreur mise Ã  jour compteur de demandes :", e);

Â  Â  Â  Â  Â  Â  Â  Â  notif.style.display = "none";

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  }



Â  Â  Â  Â  // Nouvelle fonction pour charger tous les prompts de la galerie

Â  Â  Â  Â  async function fetchGalleryPrompts() {

Â  Â  Â  Â  Â  Â  console.log("Ã‰quipe: Tentative de rÃ©cupÃ©ration des prompts de la galerie...");

Â  Â  Â  Â  Â  Â  try {

Â  Â  Â  Â  Â  Â  Â  Â  // Assurez-vous que votre fonction Netlify 'proxy' peut gÃ©rer cette action

Â  Â  Â  Â  Â  Â  Â  Â  // et qu'elle renvoie un tableau d'objets avec 'auteur' et 'imageUrl'.

Â  Â  Â  Â  Â  Â  Â  Â  const res = await fetch(`${PROXY_URL}?action=getGalleryPrompts`);

Â  Â  Â  Â  Â  Â  Â  Â  if (!res.ok) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const errorText = await res.text();

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  throw new Error(`Erreur HTTP lors de la rÃ©cupÃ©ration des prompts de galerie: ${res.status} - ${errorText}`);

Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  const data = await res.json();

Â  Â  Â  Â  Â  Â  Â  Â  // Assurez-vous que 'data' est un tableau, sinon initialisez-le comme un tableau vide

Â  Â  Â  Â  Â  Â  Â  Â  galleryPrompts = Array.isArray(data) ? data : [];

Â  Â  Â  Â  Â  Â  Â  Â  console.log("Ã‰quipe: Prompts de la galerie chargÃ©s :", galleryPrompts.length, galleryPrompts);

Â  Â  Â  Â  Â  Â  } catch (error) {

Â  Â  Â  Â  Â  Â  Â  Â  console.error("Ã‰quipe: Erreur lors du chargement des prompts de la galerie :", error);

Â  Â  Â  Â  Â  Â  Â  Â  galleryPrompts = []; // S'assurer que c'est un tableau mÃªme en cas d'erreur

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  }



Â  Â  Â  Â  // Fonction d'initialisation principale qui charge toutes les donnÃ©es nÃ©cessaires

Â  Â  Â  Â  async function initPageData() {

Â  Â  Â  Â  Â  Â  try {

Â  Â  Â  Â  Â  Â  Â  Â  // 1. Charger le header

Â  Â  Â  Â  Â  Â  Â  Â  const headerResponse = await fetch("header.html");

Â  Â  Â  Â  Â  Â  Â  Â  if (!headerResponse.ok) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  throw new Error(`Erreur HTTP lors du chargement du header pour Ã‰quipe: ${headerResponse.status}`);

Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  const headerHtml = await headerResponse.text();

Â  Â  Â  Â  Â  Â  Â  Â  const headerPlaceholder = document.getElementById("header-placeholder");

Â  Â  Â  Â  Â  Â  Â  Â  if (headerPlaceholder) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  headerPlaceholder.innerHTML = headerHtml;

Â  Â  Â  Â  Â  Â  Â  Â  } else {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.error("Ã‰quipe: L'Ã©lÃ©ment #header-placeholder n'a pas Ã©tÃ© trouvÃ©.");

Â  Â  Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  Â  Â  // 2. Charger les profils et les prompts de la galerie en parallÃ¨le

Â  Â  Â  Â  Â  Â  Â  Â  // Utilisation de Promise.all pour charger les deux sets de donnÃ©es en mÃªme temps

Â  Â  Â  Â  Â  Â  Â  Â  const [profilsResponse] = await Promise.all([

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  fetch(`${PROXY_URL}?action=getProfils`),

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  fetchGalleryPrompts() // Cette fonction met Ã  jour galleryPrompts

Â  Â  Â  Â  Â  Â  Â  Â  ]);



Â  Â  Â  Â  Â  Â  Â  Â  if (!profilsResponse.ok) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  throw new Error(`Erreur HTTP lors de la rÃ©cupÃ©ration des profils: ${profilsResponse.status}`);

Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  const profilsData = await profilsResponse.json();

Â  Â  Â  Â  Â  Â  Â  Â  profils = Array.isArray(profilsData) ? profilsData : (profilsData.profils || []);

Â  Â  Â  Â  Â  Â  Â  Â  console.log("Ã‰quipe: Profils chargÃ©s :", profils.length, profils);

Â  Â  Â  Â  Â  Â  Â  Â Â 

Â  Â  Â  Â  Â  Â  Â  Â  // 3. Afficher la page

Â  Â  Â  Â  Â  Â  Â  Â  document.body.style.opacity = "1";

Â  Â  Â  Â  Â  Â  Â  Â  const mainElement = document.querySelector("main");

Â  Â  Â  Â  Â  Â  Â  Â  if (mainElement) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  mainElement.style.display = "block";

Â  Â  Â  Â  Â  Â  Â  Â  } else {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.error("Ã‰quipe: L'Ã©lÃ©ment <main> n'a pas Ã©tÃ© trouvÃ©.");

Â  Â  Â  Â  Â  Â  Â  Â  }



Â  Â  Â  Â  Â  Â  Â  Â  mettreAJourBulleDemandes();

Â  Â  Â  Â  Â  Â  Â  Â Â 

Â  Â  Â  Â  Â  Â  Â  Â  const path = location.pathname.split("/").pop();

Â  Â  Â  Â  Â  Â  Â  Â  const links = document.querySelectorAll("nav a");

Â  Â  Â  Â  Â  Â  Â  Â  links.forEach(link => {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (link.getAttribute("href") === path) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  link.classList.add("active");

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  });



Â  Â  Â  Â  Â  Â  Â  Â  renderProfils(); // Rendre les profils initiaux avec les donnÃ©es de la galerie disponibles

Â  Â  Â  Â  Â  Â  } catch (error) {

Â  Â  Â  Â  Â  Â  Â  Â  console.error("Ã‰quipe: Erreur critique lors de l'initialisation de la page ou chargement des donnÃ©es :", error);

Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById("header-placeholder").innerHTML = "<p style='color:red;text-align:center'>Erreur de chargement du menu.</p>";

Â  Â  Â  Â  Â  Â  Â  Â  const mainElement = document.querySelector("main");

Â  Â  Â  Â  Â  Â  Â  Â  if (mainElement) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  mainElement.innerHTML = `<p style="text-align:center;color:red;padding:2rem">Impossible de charger les donnÃ©es : ${error.message}. VÃ©rifiez la console pour plus de dÃ©tails.</p>`;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  mainElement.style.display = "block";

Â  Â  Â  Â  Â  Â  Â  Â  } else {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  document.body.innerHTML += `<p style="text-align:center;color:red;padding:2rem">Impossible de charger les donnÃ©es : ${error.message}. VÃ©rifiez la console pour plus de dÃ©tails.</p>`;

Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  document.body.style.opacity = "1";

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  }



Â  Â  Â  Â  // Appeler la fonction d'initialisation globale au chargement du DOM

Â  Â  Â  Â  document.addEventListener("DOMContentLoaded", initPageData);

Â  Â  </script>

</body>

</html>
